<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>D-Bus: dbus-object-tree.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">D-Bus
   &#160;<span id="projectnumber">1.6.8</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">dbus-object-tree.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- mode: C; c-file-style: &quot;gnu&quot;; indent-tabs-mode: nil; -*- */</span>
<a name="l00002"></a>00002 <span class="comment">/* dbus-object-tree.c  DBusObjectTree (internals of DBusConnection)</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (C) 2003, 2005  Red Hat Inc.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Licensed under the Academic Free License version 2.1</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00009"></a>00009 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00010"></a>00010 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00011"></a>00011 <span class="comment"> * (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00016"></a>00016 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00019"></a>00019 <span class="comment"> * along with this program; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;config.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;dbus-object-tree.h&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;dbus-connection-internal.h&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;dbus-internals.h&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;dbus-hash.h&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;dbus-protocol.h&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;dbus-string.h&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00033"></a>00033 
<a name="l00046"></a><a class="code" href="group__DBusObjectTree.html#ga797595db73034eabb225d933f859fc48">00046</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>;
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>* _dbus_object_subtree_new   (<span class="keyword">const</span> <span class="keywordtype">char</span>                  *<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>,
<a name="l00049"></a>00049                                                       <span class="keyword">const</span> <a class="code" href="structDBusObjectPathVTable.html" title="Virtual table that must be implemented to handle a portion of the object path hierarchy.">DBusObjectPathVTable</a>  *vtable,
<a name="l00050"></a>00050                                                       <span class="keywordtype">void</span>                        *<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a>);
<a name="l00051"></a>00051 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>* _dbus_object_subtree_ref   (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>           *subtree);
<a name="l00052"></a>00052 <span class="keyword">static</span> <span class="keywordtype">void</span>               _dbus_object_subtree_unref (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>           *subtree);
<a name="l00053"></a>00053 
<a name="l00057"></a><a class="code" href="structDBusObjectTree.html">00057</a> <span class="keyword">struct </span><a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a>
<a name="l00058"></a>00058 {
<a name="l00059"></a><a class="code" href="structDBusObjectTree.html#a7d7a4cd85c747b162723a121029d9580">00059</a>   <span class="keywordtype">int</span>                 <a class="code" href="structDBusObjectTree.html#a7d7a4cd85c747b162723a121029d9580" title="Reference count.">refcount</a>;   
<a name="l00060"></a><a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100">00060</a>   <a class="code" href="structDBusConnection.html" title="Implementation details of DBusConnection.">DBusConnection</a>     *<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>; 
<a name="l00062"></a><a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26">00062</a>   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>  *<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>;       
<a name="l00063"></a>00063 };
<a name="l00064"></a>00064 
<a name="l00070"></a><a class="code" href="structDBusObjectSubtree.html">00070</a> <span class="keyword">struct </span><a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>
<a name="l00071"></a>00071 {
<a name="l00072"></a><a class="code" href="structDBusObjectSubtree.html#a45c6566f866ca45d48817f64f7f08fa6">00072</a>   <a class="code" href="structDBusAtomic.html" title="An atomic integer safe to increment or decrement from multiple threads.">DBusAtomic</a>                         <a class="code" href="structDBusObjectSubtree.html#a45c6566f866ca45d48817f64f7f08fa6" title="Reference count.">refcount</a>;            
<a name="l00073"></a><a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96">00073</a>   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>                 *<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a>;              
<a name="l00074"></a><a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6">00074</a>   <a class="code" href="group__DBusConnection.html#gaf78eab2664f8165f92db9fa9874c0b6d" title="Called when a DBusObjectPathVTable is unregistered (or its connection is freed).">DBusObjectPathUnregisterFunction</a>   <a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a>; 
<a name="l00075"></a><a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4">00075</a>   <a class="code" href="group__DBusConnection.html#ga348e43a15f8f2bc5b88651b70ec8dbdd" title="Called when a message is sent to a registered object path.">DBusObjectPathMessageFunction</a>      <a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a>;    
<a name="l00076"></a><a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807">00076</a>   <span class="keywordtype">void</span>                              *<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a>;           
<a name="l00077"></a><a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915">00077</a>   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>                **<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>;            
<a name="l00078"></a><a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed">00078</a>   <span class="keywordtype">int</span>                                <a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a>;          
<a name="l00079"></a><a class="code" href="structDBusObjectSubtree.html#ac5be3a80fa3547cea2ac7535865123c7">00079</a>   <span class="keywordtype">int</span>                                <a class="code" href="structDBusObjectSubtree.html#ac5be3a80fa3547cea2ac7535865123c7" title="Number of allocated entries in subtrees.">max_subtrees</a>;        
<a name="l00080"></a><a class="code" href="structDBusObjectSubtree.html#ab29370bdbfa87f8e6f718a3f4a20b652">00080</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                       <a class="code" href="structDBusObjectSubtree.html#ab29370bdbfa87f8e6f718a3f4a20b652" title="Whether to invoke message_function when child nodes don&#39;t handle the message.">invoke_as_fallback</a> : 1; 
<a name="l00081"></a><a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914">00081</a>   <span class="keywordtype">char</span>                               <a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>[1]; 
<a name="l00082"></a>00082 };
<a name="l00083"></a>00083 
<a name="l00091"></a>00091 <a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a>*
<a name="l00092"></a><a class="code" href="group__DBusObjectTree.html#ga5920f14b487122f13a3d439952d5ed2e">00092</a> <a class="code" href="group__DBusObjectTree.html#ga5920f14b487122f13a3d439952d5ed2e" title="Creates a new object tree, representing a mapping from paths to handler vtables.">_dbus_object_tree_new</a> (<a class="code" href="structDBusConnection.html" title="Implementation details of DBusConnection.">DBusConnection</a> *connection)
<a name="l00093"></a>00093 {
<a name="l00094"></a>00094   <a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="comment">/* the connection passed in here isn&#39;t fully constructed,</span>
<a name="l00097"></a>00097 <span class="comment">   * so don&#39;t do anything more than store a pointer to</span>
<a name="l00098"></a>00098 <span class="comment">   * it</span>
<a name="l00099"></a>00099 <span class="comment">   */</span>
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   tree = <a class="code" href="group__DBusMemory.html#gaba9d823abda7f4cadbaf5177d3b8b793" title="Safe macro for using dbus_malloc0().">dbus_new0</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a>, 1);
<a name="l00102"></a>00102   <span class="keywordflow">if</span> (tree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00103"></a>00103     <span class="keywordflow">goto</span> oom;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   tree-&gt;<a class="code" href="structDBusObjectTree.html#a7d7a4cd85c747b162723a121029d9580" title="Reference count.">refcount</a> = 1;
<a name="l00106"></a>00106   tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a> = connection;
<a name="l00107"></a>00107   tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> = _dbus_object_subtree_new (<span class="stringliteral">&quot;/&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00108"></a>00108   <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00109"></a>00109     <span class="keywordflow">goto</span> oom;
<a name="l00110"></a>00110   tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>-&gt;<a class="code" href="structDBusObjectSubtree.html#ab29370bdbfa87f8e6f718a3f4a20b652" title="Whether to invoke message_function when child nodes don&#39;t handle the message.">invoke_as_fallback</a> = <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l00111"></a>00111   
<a name="l00112"></a>00112   <span class="keywordflow">return</span> tree;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114  oom:
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (tree)
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117       <a class="code" href="group__DBusMemory.html#ga34e666b19b015035a9a31e53da84b39a" title="Frees a block of memory previously allocated by dbus_malloc() or dbus_malloc0().">dbus_free</a> (tree);
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00121"></a>00121 }
<a name="l00122"></a>00122 
<a name="l00128"></a>00128 <a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *
<a name="l00129"></a><a class="code" href="group__DBusObjectTree.html#ga144a3920922e8badf1018ce22b27d9c4">00129</a> <a class="code" href="group__DBusObjectTree.html#ga144a3920922e8badf1018ce22b27d9c4" title="Increment the reference count.">_dbus_object_tree_ref</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree)
<a name="l00130"></a>00130 {
<a name="l00131"></a>00131   _dbus_assert (tree-&gt;<a class="code" href="structDBusObjectTree.html#a7d7a4cd85c747b162723a121029d9580" title="Reference count.">refcount</a> &gt; 0);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   tree-&gt;<a class="code" href="structDBusObjectTree.html#a7d7a4cd85c747b162723a121029d9580" title="Reference count.">refcount</a> += 1;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135   <span class="keywordflow">return</span> tree;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00142"></a>00142 <span class="keywordtype">void</span>
<a name="l00143"></a><a class="code" href="group__DBusObjectTree.html#ga7639e273ab160c422a7cef0cda60ded5">00143</a> <a class="code" href="group__DBusObjectTree.html#ga7639e273ab160c422a7cef0cda60ded5" title="Decrement the reference count.">_dbus_object_tree_unref</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree)
<a name="l00144"></a>00144 {
<a name="l00145"></a>00145   _dbus_assert (tree-&gt;<a class="code" href="structDBusObjectTree.html#a7d7a4cd85c747b162723a121029d9580" title="Reference count.">refcount</a> &gt; 0);
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   tree-&gt;<a class="code" href="structDBusObjectTree.html#a7d7a4cd85c747b162723a121029d9580" title="Reference count.">refcount</a> -= 1;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149   <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a7d7a4cd85c747b162723a121029d9580" title="Reference count.">refcount</a> == 0)
<a name="l00150"></a>00150     {
<a name="l00151"></a>00151       <a class="code" href="group__DBusObjectTree.html#ga1c51e43233ce0f3855c128f2555317eb" title="Free all the handlers in the tree.">_dbus_object_tree_free_all_unlocked</a> (tree);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153       <a class="code" href="group__DBusMemory.html#ga34e666b19b015035a9a31e53da84b39a" title="Frees a block of memory previously allocated by dbus_malloc() or dbus_malloc0().">dbus_free</a> (tree);
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155 }
<a name="l00156"></a>00156 
<a name="l00160"></a><a class="code" href="group__DBusObjectTree.html#ga7c65e59e0445cd294f82a4fb42e44772">00160</a> <span class="preprocessor">#define VERBOSE_FIND 0</span>
<a name="l00161"></a>00161 <span class="preprocessor"></span>
<a name="l00162"></a>00162 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>*
<a name="l00163"></a>00163 find_subtree_recurse (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>  *subtree,
<a name="l00164"></a>00164                       <span class="keyword">const</span> <span class="keywordtype">char</span>        **path,
<a name="l00165"></a>00165                       <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>         create_if_not_found,
<a name="l00166"></a>00166                       <span class="keywordtype">int</span>                *index_in_parent,
<a name="l00167"></a>00167                       <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>        *exact_match)
<a name="l00168"></a>00168 {
<a name="l00169"></a>00169   <span class="keywordtype">int</span> i, j;
<a name="l00170"></a>00170   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> return_deepest_match;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   return_deepest_match = exact_match != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174   _dbus_assert (!(return_deepest_match &amp;&amp; create_if_not_found));
<a name="l00175"></a>00175 
<a name="l00176"></a>00176   <span class="keywordflow">if</span> (path[0] == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00177"></a>00177     {
<a name="l00178"></a>00178 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00179"></a>00179 <span class="preprocessor"></span>      _dbus_verbose (<span class="stringliteral">&quot;  path exhausted, returning %s\n&quot;</span>,
<a name="l00180"></a>00180                      subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>);
<a name="l00181"></a>00181 <span class="preprocessor">#endif</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (exact_match != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00183"></a>00183         *exact_match = <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l00184"></a>00184       <span class="keywordflow">return</span> subtree;
<a name="l00185"></a>00185     }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span>  _dbus_verbose (<span class="stringliteral">&quot;  searching children of %s for %s\n&quot;</span>,
<a name="l00189"></a>00189                  subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>, path[0]);
<a name="l00190"></a>00190 <span class="preprocessor">#endif</span>
<a name="l00191"></a>00191 <span class="preprocessor"></span>  
<a name="l00192"></a>00192   i = 0;
<a name="l00193"></a>00193   j = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a>;
<a name="l00194"></a>00194   <span class="keywordflow">while</span> (i &lt; j)
<a name="l00195"></a>00195     {
<a name="l00196"></a>00196       <span class="keywordtype">int</span> k, v;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198       k = (i + j) / 2;
<a name="l00199"></a>00199       v = strcmp (path[0], subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[k]-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span>      _dbus_verbose (<span class="stringliteral">&quot;  %s cmp %s = %d\n&quot;</span>,
<a name="l00203"></a>00203                      path[0], subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[k]-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>,
<a name="l00204"></a>00204                      v);
<a name="l00205"></a>00205 <span class="preprocessor">#endif</span>
<a name="l00206"></a>00206 <span class="preprocessor"></span>      
<a name="l00207"></a>00207       <span class="keywordflow">if</span> (v == 0)
<a name="l00208"></a>00208         {
<a name="l00209"></a>00209           <span class="keywordflow">if</span> (index_in_parent)
<a name="l00210"></a>00210             {
<a name="l00211"></a>00211 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span>              _dbus_verbose (<span class="stringliteral">&quot;  storing parent index %d\n&quot;</span>, k);
<a name="l00213"></a>00213 <span class="preprocessor">#endif</span>
<a name="l00214"></a>00214 <span class="preprocessor"></span>              *index_in_parent = k;
<a name="l00215"></a>00215             }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217           <span class="keywordflow">if</span> (return_deepest_match)
<a name="l00218"></a>00218             {
<a name="l00219"></a>00219               <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *next;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221               next = find_subtree_recurse (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[k],
<a name="l00222"></a>00222                                            &amp;path[1], create_if_not_found, 
<a name="l00223"></a>00223                                            index_in_parent, exact_match);
<a name="l00224"></a>00224               <span class="keywordflow">if</span> (next == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> &amp;&amp;
<a name="l00225"></a>00225                   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ab29370bdbfa87f8e6f718a3f4a20b652" title="Whether to invoke message_function when child nodes don&#39;t handle the message.">invoke_as_fallback</a>)
<a name="l00226"></a>00226                 {
<a name="l00227"></a>00227 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00228"></a>00228 <span class="preprocessor"></span>                  _dbus_verbose (<span class="stringliteral">&quot;  no deeper match found, returning %s\n&quot;</span>,
<a name="l00229"></a>00229                                  subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>);
<a name="l00230"></a>00230 <span class="preprocessor">#endif</span>
<a name="l00231"></a>00231 <span class="preprocessor"></span>                  <span class="keywordflow">if</span> (exact_match != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00232"></a>00232                     *exact_match = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l00233"></a>00233                   <span class="keywordflow">return</span> subtree;
<a name="l00234"></a>00234                 }
<a name="l00235"></a>00235               <span class="keywordflow">else</span>
<a name="l00236"></a>00236                 <span class="keywordflow">return</span> next;
<a name="l00237"></a>00237             }
<a name="l00238"></a>00238           <span class="keywordflow">else</span>
<a name="l00239"></a>00239             <span class="keywordflow">return</span> find_subtree_recurse (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[k],
<a name="l00240"></a>00240                                          &amp;path[1], create_if_not_found, 
<a name="l00241"></a>00241                                          index_in_parent, exact_match);
<a name="l00242"></a>00242         }
<a name="l00243"></a>00243       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v &lt; 0)
<a name="l00244"></a>00244         {
<a name="l00245"></a>00245           j = k;
<a name="l00246"></a>00246         }
<a name="l00247"></a>00247       <span class="keywordflow">else</span>
<a name="l00248"></a>00248         {
<a name="l00249"></a>00249           i = k + 1;
<a name="l00250"></a>00250         }
<a name="l00251"></a>00251     }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00254"></a>00254 <span class="preprocessor"></span>  _dbus_verbose (<span class="stringliteral">&quot;  no match found, current tree %s, create_if_not_found = %d\n&quot;</span>,
<a name="l00255"></a>00255                  subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>, create_if_not_found);
<a name="l00256"></a>00256 <span class="preprocessor">#endif</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span>  
<a name="l00258"></a>00258   <span class="keywordflow">if</span> (create_if_not_found)
<a name="l00259"></a>00259     {
<a name="l00260"></a>00260       <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>* child;
<a name="l00261"></a>00261       <span class="keywordtype">int</span> child_pos, new_n_subtrees;
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span>      _dbus_verbose (<span class="stringliteral">&quot;  creating subtree %s\n&quot;</span>,
<a name="l00265"></a>00265                      path[0]);
<a name="l00266"></a>00266 <span class="preprocessor">#endif</span>
<a name="l00267"></a>00267 <span class="preprocessor"></span>      
<a name="l00268"></a>00268       child = _dbus_object_subtree_new (path[0],
<a name="l00269"></a>00269                                         <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00270"></a>00270       <span class="keywordflow">if</span> (child == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00271"></a>00271         <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273       new_n_subtrees = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> + 1;
<a name="l00274"></a>00274       <span class="keywordflow">if</span> (new_n_subtrees &gt; subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac5be3a80fa3547cea2ac7535865123c7" title="Number of allocated entries in subtrees.">max_subtrees</a>)
<a name="l00275"></a>00275         {
<a name="l00276"></a>00276           <span class="keywordtype">int</span> new_max_subtrees;
<a name="l00277"></a>00277           <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> **new_subtrees;
<a name="l00278"></a>00278 
<a name="l00279"></a>00279           new_max_subtrees = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac5be3a80fa3547cea2ac7535865123c7" title="Number of allocated entries in subtrees.">max_subtrees</a> == 0 ? 1 : 2 * subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac5be3a80fa3547cea2ac7535865123c7" title="Number of allocated entries in subtrees.">max_subtrees</a>;
<a name="l00280"></a>00280           new_subtrees = <a class="code" href="group__DBusMemory.html#ga2d505f2960ccf343042d363170b27f9c" title="Resizes a block of memory previously allocated by dbus_malloc() or dbus_malloc0().">dbus_realloc</a> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>,
<a name="l00281"></a>00281                                        new_max_subtrees * sizeof (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>*));
<a name="l00282"></a>00282           <span class="keywordflow">if</span> (new_subtrees == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00283"></a>00283             {
<a name="l00284"></a>00284               _dbus_object_subtree_unref (child);
<a name="l00285"></a>00285               <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00286"></a>00286             }
<a name="l00287"></a>00287           subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a> = new_subtrees;
<a name="l00288"></a>00288           subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac5be3a80fa3547cea2ac7535865123c7" title="Number of allocated entries in subtrees.">max_subtrees</a> = new_max_subtrees;
<a name="l00289"></a>00289         }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291       <span class="comment">/* The binary search failed, so i == j points to the </span>
<a name="l00292"></a>00292 <span class="comment">         place the child should be inserted. */</span>
<a name="l00293"></a>00293       child_pos = i;
<a name="l00294"></a>00294       _dbus_assert (child_pos &lt; new_n_subtrees &amp;&amp;
<a name="l00295"></a>00295                     new_n_subtrees &lt;= subtree-&gt;max_subtrees);
<a name="l00296"></a>00296       <span class="keywordflow">if</span> (child_pos + 1 &lt; new_n_subtrees)
<a name="l00297"></a>00297         {
<a name="l00298"></a>00298           memmove (&amp;subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[child_pos+1], 
<a name="l00299"></a>00299                    &amp;subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[child_pos], 
<a name="l00300"></a>00300                    (new_n_subtrees - child_pos - 1) * 
<a name="l00301"></a>00301                    <span class="keyword">sizeof</span> subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[0]);
<a name="l00302"></a>00302         }
<a name="l00303"></a>00303       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[child_pos] = child;
<a name="l00304"></a>00304 
<a name="l00305"></a>00305       <span class="keywordflow">if</span> (index_in_parent)
<a name="l00306"></a>00306         *index_in_parent = child_pos;
<a name="l00307"></a>00307       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> = new_n_subtrees;
<a name="l00308"></a>00308       child-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a> = subtree;
<a name="l00309"></a>00309 
<a name="l00310"></a>00310       <span class="keywordflow">return</span> find_subtree_recurse (child,
<a name="l00311"></a>00311                                    &amp;path[1], create_if_not_found, 
<a name="l00312"></a>00312                                    index_in_parent, exact_match);
<a name="l00313"></a>00313     }
<a name="l00314"></a>00314   <span class="keywordflow">else</span>
<a name="l00315"></a>00315     {
<a name="l00316"></a>00316       <span class="keywordflow">if</span> (exact_match != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00317"></a>00317         *exact_match = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l00318"></a>00318       <span class="keywordflow">return</span> (return_deepest_match &amp;&amp; subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ab29370bdbfa87f8e6f718a3f4a20b652" title="Whether to invoke message_function when child nodes don&#39;t handle the message.">invoke_as_fallback</a>) ? subtree : <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>*
<a name="l00323"></a>00323 find_subtree (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l00324"></a>00324               <span class="keyword">const</span> <span class="keywordtype">char</span>    **path,
<a name="l00325"></a>00325               <span class="keywordtype">int</span>            *index_in_parent)
<a name="l00326"></a>00326 {
<a name="l00327"></a>00327   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree;
<a name="l00328"></a>00328 
<a name="l00329"></a>00329 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00330"></a>00330 <span class="preprocessor"></span>  _dbus_verbose (<span class="stringliteral">&quot;Looking for exact registered subtree\n&quot;</span>);
<a name="l00331"></a>00331 <span class="preprocessor">#endif</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span>  
<a name="l00333"></a>00333   subtree = find_subtree_recurse (tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>, path, <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>, index_in_parent, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00334"></a>00334 
<a name="l00335"></a>00335   <span class="keywordflow">if</span> (subtree &amp;&amp; subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00336"></a>00336     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00337"></a>00337   <span class="keywordflow">else</span>
<a name="l00338"></a>00338     <span class="keywordflow">return</span> subtree;
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>*
<a name="l00342"></a>00342 lookup_subtree (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l00343"></a>00343                 <span class="keyword">const</span> <span class="keywordtype">char</span>    **path)
<a name="l00344"></a>00344 {
<a name="l00345"></a>00345 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00346"></a>00346 <span class="preprocessor"></span>  _dbus_verbose (<span class="stringliteral">&quot;Looking for subtree\n&quot;</span>);
<a name="l00347"></a>00347 <span class="preprocessor">#endif</span>
<a name="l00348"></a>00348 <span class="preprocessor"></span>  <span class="keywordflow">return</span> find_subtree_recurse (tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>, path, <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00349"></a>00349 }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>*
<a name="l00352"></a>00352 find_handler (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l00353"></a>00353               <span class="keyword">const</span> <span class="keywordtype">char</span>    **path,
<a name="l00354"></a>00354               <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>    *exact_match)
<a name="l00355"></a>00355 {
<a name="l00356"></a>00356 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00357"></a>00357 <span class="preprocessor"></span>  _dbus_verbose (<span class="stringliteral">&quot;Looking for deepest handler\n&quot;</span>);
<a name="l00358"></a>00358 <span class="preprocessor">#endif</span>
<a name="l00359"></a>00359 <span class="preprocessor"></span>  _dbus_assert (exact_match != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   *exact_match = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>; <span class="comment">/* ensure always initialized */</span>
<a name="l00362"></a>00362   
<a name="l00363"></a>00363   <span class="keywordflow">return</span> find_subtree_recurse (tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>, path, <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>, exact_match);
<a name="l00364"></a>00364 }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>*
<a name="l00367"></a>00367 ensure_subtree (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l00368"></a>00368                 <span class="keyword">const</span> <span class="keywordtype">char</span>    **path)
<a name="l00369"></a>00369 {
<a name="l00370"></a>00370 <span class="preprocessor">#if VERBOSE_FIND</span>
<a name="l00371"></a>00371 <span class="preprocessor"></span>  _dbus_verbose (<span class="stringliteral">&quot;Ensuring subtree\n&quot;</span>);
<a name="l00372"></a>00372 <span class="preprocessor">#endif</span>
<a name="l00373"></a>00373 <span class="preprocessor"></span>  <span class="keywordflow">return</span> find_subtree_recurse (tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>, path, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00374"></a>00374 }
<a name="l00375"></a>00375 
<a name="l00376"></a>00376 <span class="keyword">static</span> <span class="keywordtype">char</span> *flatten_path (<span class="keyword">const</span> <span class="keywordtype">char</span> **path);
<a name="l00377"></a>00377 
<a name="l00390"></a>00390 <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l00391"></a><a class="code" href="group__DBusObjectTree.html#gab3da15ee1a73d3b26008d1bce20a78a0">00391</a> <a class="code" href="group__DBusObjectTree.html#gab3da15ee1a73d3b26008d1bce20a78a0" title="Registers a new subtree in the global object tree.">_dbus_object_tree_register</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a>              *tree,
<a name="l00392"></a>00392                             <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>                  fallback,
<a name="l00393"></a>00393                             <span class="keyword">const</span> <span class="keywordtype">char</span>                 **path,
<a name="l00394"></a>00394                             <span class="keyword">const</span> <a class="code" href="structDBusObjectPathVTable.html" title="Virtual table that must be implemented to handle a portion of the object path hierarchy.">DBusObjectPathVTable</a>  *vtable,
<a name="l00395"></a>00395                             <span class="keywordtype">void</span>                        *user_data,
<a name="l00396"></a>00396                             <a class="code" href="structDBusError.html" title="Object representing an exception.">DBusError</a>                   *error)
<a name="l00397"></a>00397 {
<a name="l00398"></a>00398   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>  *subtree;
<a name="l00399"></a>00399 
<a name="l00400"></a>00400   _dbus_assert (tree != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00401"></a>00401   _dbus_assert (vtable-&gt;<a class="code" href="structDBusObjectPathVTable.html#a83464b6b8b66fb7adebd8e3bf8ff1b70" title="Function to handle messages.">message_function</a> != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00402"></a>00402   _dbus_assert (path != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00403"></a>00403 
<a name="l00404"></a>00404   subtree = ensure_subtree (tree, path);
<a name="l00405"></a>00405   <span class="keywordflow">if</span> (subtree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00406"></a>00406     {
<a name="l00407"></a>00407       _DBUS_SET_OOM (error);
<a name="l00408"></a>00408       <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l00409"></a>00409     }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411   <span class="keywordflow">if</span> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00412"></a>00412     {
<a name="l00413"></a>00413       <span class="keywordflow">if</span> (error != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00414"></a>00414         {
<a name="l00415"></a>00415           <span class="keywordtype">char</span> *complete_path = flatten_path (path);
<a name="l00416"></a>00416 
<a name="l00417"></a>00417           <a class="code" href="group__DBusErrors.html#ga89d2ad4bde21f9e0057fac07a79885e3" title="Assigns an error name and message to a DBusError.">dbus_set_error</a> (error, <a class="code" href="group__DBusProtocol.html#ga6a4358a62f0cd68d637532772475e576" title="There&#39;s already an object with the requested object path.">DBUS_ERROR_OBJECT_PATH_IN_USE</a>,
<a name="l00418"></a>00418                           <span class="stringliteral">&quot;A handler is already registered for %s&quot;</span>,
<a name="l00419"></a>00419                           complete_path ? complete_path
<a name="l00420"></a>00420                                         : <span class="stringliteral">&quot;(cannot represent path: out of memory!)&quot;</span>);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422           <a class="code" href="group__DBusMemory.html#ga34e666b19b015035a9a31e53da84b39a" title="Frees a block of memory previously allocated by dbus_malloc() or dbus_malloc0().">dbus_free</a> (complete_path);
<a name="l00423"></a>00423         }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425       <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l00426"></a>00426     }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> = vtable-&gt;<a class="code" href="structDBusObjectPathVTable.html#a83464b6b8b66fb7adebd8e3bf8ff1b70" title="Function to handle messages.">message_function</a>;
<a name="l00429"></a>00429   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a> = vtable-&gt;<a class="code" href="structDBusObjectPathVTable.html#abb6c084f345051b9649615b91ec654d4" title="Function to unregister this handler.">unregister_function</a>;
<a name="l00430"></a>00430   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a> = user_data;
<a name="l00431"></a>00431   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ab29370bdbfa87f8e6f718a3f4a20b652" title="Whether to invoke message_function when child nodes don&#39;t handle the message.">invoke_as_fallback</a> = fallback != <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l00434"></a>00434 }
<a name="l00435"></a>00435 
<a name="l00443"></a>00443 <span class="keywordtype">void</span>
<a name="l00444"></a><a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75">00444</a> <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a>          *tree,
<a name="l00445"></a>00445                                          <span class="keyword">const</span> <span class="keywordtype">char</span>             **path)
<a name="l00446"></a>00446 {
<a name="l00447"></a>00447   <span class="keywordtype">int</span> i;
<a name="l00448"></a>00448   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree;
<a name="l00449"></a>00449   <a class="code" href="group__DBusConnection.html#gaf78eab2664f8165f92db9fa9874c0b6d" title="Called when a DBusObjectPathVTable is unregistered (or its connection is freed).">DBusObjectPathUnregisterFunction</a> unregister_function;
<a name="l00450"></a>00450   <span class="keywordtype">void</span> *user_data;
<a name="l00451"></a>00451   <a class="code" href="structDBusConnection.html" title="Implementation details of DBusConnection.">DBusConnection</a> *connection;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453   _dbus_assert (path != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00454"></a>00454 
<a name="l00455"></a>00455   unregister_function = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00456"></a>00456   user_data = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00457"></a>00457 
<a name="l00458"></a>00458   subtree = find_subtree (tree, path, &amp;i);
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <span class="preprocessor">#ifndef DBUS_DISABLE_CHECKS</span>
<a name="l00461"></a>00461 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (subtree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00462"></a>00462     {
<a name="l00463"></a>00463       <a class="code" href="group__DBusInternalsUtils.html#gabea2c16d6d3fe7c4eb5b9496fc877f84" title="Prints a warning message to stderr.">_dbus_warn</a> (<span class="stringliteral">&quot;Attempted to unregister path (path[0] = %s path[1] = %s) which isn&#39;t registered\n&quot;</span>,
<a name="l00464"></a>00464                   path[0] ? path[0] : <span class="stringliteral">&quot;null&quot;</span>,
<a name="l00465"></a>00465                   path[1] ? path[1] : <span class="stringliteral">&quot;null&quot;</span>);
<a name="l00466"></a>00466       <span class="keywordflow">goto</span> unlock;    
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468 <span class="preprocessor">#else</span>
<a name="l00469"></a>00469 <span class="preprocessor"></span>  _dbus_assert (subtree != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00470"></a>00470 <span class="preprocessor">#endif</span>
<a name="l00471"></a>00471 <span class="preprocessor"></span>
<a name="l00472"></a>00472   _dbus_assert (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a> == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> ||
<a name="l00473"></a>00473                 (i &gt;= 0 &amp;&amp; subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a>-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[i] == subtree));
<a name="l00474"></a>00474 
<a name="l00475"></a>00475   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   unregister_function = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a>;
<a name="l00478"></a>00478   user_data = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a>;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00481"></a>00481   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483   <span class="comment">/* If we have no subtrees of our own, remove from</span>
<a name="l00484"></a>00484 <span class="comment">   * our parent (FIXME could also be more aggressive</span>
<a name="l00485"></a>00485 <span class="comment">   * and remove our parent if it becomes empty)</span>
<a name="l00486"></a>00486 <span class="comment">   */</span>
<a name="l00487"></a>00487   <span class="keywordflow">if</span> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a> &amp;&amp; subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> == 0)
<a name="l00488"></a>00488     {
<a name="l00489"></a>00489       <span class="comment">/* assumes a 0-byte memmove is OK */</span>
<a name="l00490"></a>00490       memmove (&amp;subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a>-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[i],
<a name="l00491"></a>00491                &amp;subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a>-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[i+1],
<a name="l00492"></a>00492                (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a>-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> - i - 1) *
<a name="l00493"></a>00493                sizeof (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a>-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[0]));
<a name="l00494"></a>00494       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a>-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> -= 1;
<a name="l00495"></a>00495 
<a name="l00496"></a>00496       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498       _dbus_object_subtree_unref (subtree);
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500   subtree = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 unlock:
<a name="l00503"></a>00503   connection = tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>;
<a name="l00504"></a>00504 
<a name="l00505"></a>00505   <span class="comment">/* Unlock and call application code */</span>
<a name="l00506"></a>00506 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00507"></a>00507 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (connection)
<a name="l00508"></a>00508 <span class="preprocessor">#endif</span>
<a name="l00509"></a>00509 <span class="preprocessor"></span>    {
<a name="l00510"></a>00510       <a class="code" href="group__DBusConnectionInternals.html#ga7151f75b5d2308ec80cfe893aba72aa1" title="Increments the reference count of a DBusConnection.">_dbus_connection_ref_unlocked</a> (connection);
<a name="l00511"></a>00511       _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l00512"></a>00512       <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (connection);
<a name="l00513"></a>00513     }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515   <span class="keywordflow">if</span> (unregister_function)
<a name="l00516"></a>00516     (* unregister_function) (connection, user_data);
<a name="l00517"></a>00517 
<a name="l00518"></a>00518 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00519"></a>00519 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (connection)
<a name="l00520"></a>00520 <span class="preprocessor">#endif</span>
<a name="l00521"></a>00521 <span class="preprocessor"></span>    <a class="code" href="group__DBusConnection.html#ga6385ff09bc108238c4429e7c195dab25" title="Decrements the reference count of a DBusConnection, and finalizes it if the count reaches zero...">dbus_connection_unref</a> (connection);
<a name="l00522"></a>00522 }
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00525"></a>00525 free_subtree_recurse (<a class="code" href="structDBusConnection.html" title="Implementation details of DBusConnection.">DBusConnection</a>    *connection,
<a name="l00526"></a>00526                       <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree)
<a name="l00527"></a>00527 {
<a name="l00528"></a>00528   <span class="comment">/* Delete them from the end, for slightly</span>
<a name="l00529"></a>00529 <span class="comment">   * more robustness against odd reentrancy.</span>
<a name="l00530"></a>00530 <span class="comment">   */</span>
<a name="l00531"></a>00531   <span class="keywordflow">while</span> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> &gt; 0)
<a name="l00532"></a>00532     {
<a name="l00533"></a>00533       <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *child;
<a name="l00534"></a>00534 
<a name="l00535"></a>00535       child = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> - 1];
<a name="l00536"></a>00536       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> - 1] = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00537"></a>00537       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> -= 1;
<a name="l00538"></a>00538       child-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540       free_subtree_recurse (connection, child);
<a name="l00541"></a>00541     }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543   <span class="comment">/* Call application code */</span>
<a name="l00544"></a>00544   <span class="keywordflow">if</span> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a>)
<a name="l00545"></a>00545     (* subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a>) (connection,
<a name="l00546"></a>00546                                       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a>);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00549"></a>00549   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00550"></a>00550   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00551"></a>00551 
<a name="l00552"></a>00552   <span class="comment">/* Now free ourselves */</span>
<a name="l00553"></a>00553   _dbus_object_subtree_unref (subtree);
<a name="l00554"></a>00554 }
<a name="l00555"></a>00555 
<a name="l00562"></a>00562 <span class="keywordtype">void</span>
<a name="l00563"></a><a class="code" href="group__DBusObjectTree.html#ga1c51e43233ce0f3855c128f2555317eb">00563</a> <a class="code" href="group__DBusObjectTree.html#ga1c51e43233ce0f3855c128f2555317eb" title="Free all the handlers in the tree.">_dbus_object_tree_free_all_unlocked</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree)
<a name="l00564"></a>00564 {
<a name="l00565"></a>00565   <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>)
<a name="l00566"></a>00566     free_subtree_recurse (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>,
<a name="l00567"></a>00567                           tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>);
<a name="l00568"></a>00568   tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00569"></a>00569 }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 <span class="keyword">static</span> <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l00572"></a>00572 _dbus_object_tree_list_registered_unlocked (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l00573"></a>00573                                             <span class="keyword">const</span> <span class="keywordtype">char</span>    **parent_path,
<a name="l00574"></a>00574                                             <span class="keywordtype">char</span>         ***child_entries)
<a name="l00575"></a>00575 {
<a name="l00576"></a>00576   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree;
<a name="l00577"></a>00577   <span class="keywordtype">char</span> **retval;
<a name="l00578"></a>00578   
<a name="l00579"></a>00579   _dbus_assert (parent_path != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00580"></a>00580   _dbus_assert (child_entries != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582   *child_entries = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00583"></a>00583   
<a name="l00584"></a>00584   subtree = lookup_subtree (tree, parent_path);
<a name="l00585"></a>00585   <span class="keywordflow">if</span> (subtree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00586"></a>00586     {
<a name="l00587"></a>00587       retval = <a class="code" href="group__DBusMemory.html#gaba9d823abda7f4cadbaf5177d3b8b793" title="Safe macro for using dbus_malloc0().">dbus_new0</a> (<span class="keywordtype">char</span> *, 1);
<a name="l00588"></a>00588     }
<a name="l00589"></a>00589   <span class="keywordflow">else</span>
<a name="l00590"></a>00590     {
<a name="l00591"></a>00591       <span class="keywordtype">int</span> i;
<a name="l00592"></a>00592       retval = <a class="code" href="group__DBusMemory.html#gaba9d823abda7f4cadbaf5177d3b8b793" title="Safe macro for using dbus_malloc0().">dbus_new0</a> (<span class="keywordtype">char</span>*, subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> + 1);
<a name="l00593"></a>00593       <span class="keywordflow">if</span> (retval == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00594"></a>00594         <span class="keywordflow">goto</span> out;
<a name="l00595"></a>00595       i = 0;
<a name="l00596"></a>00596       <span class="keywordflow">while</span> (i &lt; subtree-&gt;n_subtrees)
<a name="l00597"></a>00597         {
<a name="l00598"></a>00598           retval[i] = <a class="code" href="group__DBusInternalsUtils.html#ga9d00d77f6595b9d7ac1baf59d44bf58c" title="Duplicates a string.">_dbus_strdup</a> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[i]-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>);
<a name="l00599"></a>00599           <span class="keywordflow">if</span> (retval[i] == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00600"></a>00600             {
<a name="l00601"></a>00601               <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (retval);
<a name="l00602"></a>00602               retval = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00603"></a>00603               <span class="keywordflow">goto</span> out;
<a name="l00604"></a>00604             }
<a name="l00605"></a>00605           ++i;
<a name="l00606"></a>00606         }
<a name="l00607"></a>00607     }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609  out:
<a name="l00610"></a>00610     
<a name="l00611"></a>00611   *child_entries = retval;
<a name="l00612"></a>00612   <span class="keywordflow">return</span> retval != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 <span class="keyword">static</span> <a class="code" href="group__DBusShared.html#ga8244b29230187624c24986c24edab1de" title="Results that a message handler can return.">DBusHandlerResult</a>
<a name="l00616"></a>00616 handle_default_introspect_and_unlock (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a>          *tree,
<a name="l00617"></a>00617                                       <a class="code" href="structDBusMessage.html" title="Internals of DBusMessage.">DBusMessage</a>             *message,
<a name="l00618"></a>00618                                       <span class="keyword">const</span> <span class="keywordtype">char</span>             **path)
<a name="l00619"></a>00619 {
<a name="l00620"></a>00620   <a class="code" href="structDBusString.html">DBusString</a> xml;
<a name="l00621"></a>00621   <a class="code" href="group__DBusShared.html#ga8244b29230187624c24986c24edab1de" title="Results that a message handler can return.">DBusHandlerResult</a> result;
<a name="l00622"></a>00622   <span class="keywordtype">char</span> **children;
<a name="l00623"></a>00623   <span class="keywordtype">int</span> i;
<a name="l00624"></a>00624   <a class="code" href="structDBusMessage.html" title="Internals of DBusMessage.">DBusMessage</a> *reply;
<a name="l00625"></a>00625   <a class="code" href="structDBusMessageIter.html" title="DBusMessageIter struct; contains no public fields.">DBusMessageIter</a> iter;
<a name="l00626"></a>00626   <span class="keyword">const</span> <span class="keywordtype">char</span> *v_STRING;
<a name="l00627"></a>00627   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> already_unlocked;
<a name="l00628"></a>00628 
<a name="l00629"></a>00629   <span class="comment">/* We have the connection lock here */</span>
<a name="l00630"></a>00630 
<a name="l00631"></a>00631   already_unlocked = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l00632"></a>00632   
<a name="l00633"></a>00633   _dbus_verbose (<span class="stringliteral">&quot; considering default Introspect() handler...\n&quot;</span>);
<a name="l00634"></a>00634 
<a name="l00635"></a>00635   reply = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00636"></a>00636   
<a name="l00637"></a>00637   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusMessage.html#ga9287d997d0d3f0f1622457fcaceee196" title="Checks whether the message is a method call with the given interface and member fields.">dbus_message_is_method_call</a> (message,
<a name="l00638"></a>00638                                     <a class="code" href="group__DBusShared.html#gafe8861886c0b53c1000fb322fd84641b" title="The interface supported by introspectable objects.">DBUS_INTERFACE_INTROSPECTABLE</a>,
<a name="l00639"></a>00639                                     <span class="stringliteral">&quot;Introspect&quot;</span>))
<a name="l00640"></a>00640     {
<a name="l00641"></a>00641 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00642"></a>00642 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00643"></a>00643 <span class="preprocessor">#endif</span>
<a name="l00644"></a>00644 <span class="preprocessor"></span>        {
<a name="l00645"></a>00645           _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l00646"></a>00646           <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l00647"></a>00647         }
<a name="l00648"></a>00648       
<a name="l00649"></a>00649       <span class="keywordflow">return</span> <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1deacb84b64c92055f2585fe9c29f1e5df68" title="Message has not had any effect - see if other handlers want it.">DBUS_HANDLER_RESULT_NOT_YET_HANDLED</a>;
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651 
<a name="l00652"></a>00652   _dbus_verbose (<span class="stringliteral">&quot; using default Introspect() handler!\n&quot;</span>);
<a name="l00653"></a>00653   
<a name="l00654"></a>00654   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#ga348252317f7bb8ac43529972945830ae" title="Initializes a string.">_dbus_string_init</a> (&amp;xml))
<a name="l00655"></a>00655     {
<a name="l00656"></a>00656 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00657"></a>00657 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00658"></a>00658 <span class="preprocessor">#endif</span>
<a name="l00659"></a>00659 <span class="preprocessor"></span>        {
<a name="l00660"></a>00660           _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l00661"></a>00661           <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l00662"></a>00662         }
<a name="l00663"></a>00663 
<a name="l00664"></a>00664       <span class="keywordflow">return</span> <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1dea01f00ce4578559c7b14b91256bfede7d" title="Need more memory in order to return DBUS_HANDLER_RESULT_HANDLED or DBUS_HANDLER_RESULT_NOT_YET_HANDLE...">DBUS_HANDLER_RESULT_NEED_MEMORY</a>;
<a name="l00665"></a>00665     }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667   result = <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1dea01f00ce4578559c7b14b91256bfede7d" title="Need more memory in order to return DBUS_HANDLER_RESULT_HANDLED or DBUS_HANDLER_RESULT_NOT_YET_HANDLE...">DBUS_HANDLER_RESULT_NEED_MEMORY</a>;
<a name="l00668"></a>00668 
<a name="l00669"></a>00669   children = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00670"></a>00670   <span class="keywordflow">if</span> (!_dbus_object_tree_list_registered_unlocked (tree, path, &amp;children))
<a name="l00671"></a>00671     <span class="keywordflow">goto</span> out;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#ga100c5ce0696822c5a4cfbdfaba674d96" title="Appends a nul-terminated C-style string to a DBusString.">_dbus_string_append</a> (&amp;xml, <a class="code" href="group__DBusProtocol.html#ga5e7de0ccf222f5fa69241e517824b712" title="XML document type declaration of the introspection format version 1.0.">DBUS_INTROSPECT_1_0_XML_DOCTYPE_DECL_NODE</a>))
<a name="l00674"></a>00674     <span class="keywordflow">goto</span> out;
<a name="l00675"></a>00675   
<a name="l00676"></a>00676   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#ga100c5ce0696822c5a4cfbdfaba674d96" title="Appends a nul-terminated C-style string to a DBusString.">_dbus_string_append</a> (&amp;xml, <span class="stringliteral">&quot;&lt;node&gt;\n&quot;</span>))
<a name="l00677"></a>00677     <span class="keywordflow">goto</span> out;
<a name="l00678"></a>00678 
<a name="l00679"></a>00679   i = 0;
<a name="l00680"></a>00680   <span class="keywordflow">while</span> (children[i] != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00681"></a>00681     {
<a name="l00682"></a>00682       <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#gab0078cf7e0e5bd784ec6d6e0cc3923a2" title="Appends a printf-style formatted string to the DBusString.">_dbus_string_append_printf</a> (&amp;xml, <span class="stringliteral">&quot;  &lt;node name=\&quot;%s\&quot;/&gt;\n&quot;</span>,
<a name="l00683"></a>00683                                        children[i]))
<a name="l00684"></a>00684         <span class="keywordflow">goto</span> out;
<a name="l00685"></a>00685 
<a name="l00686"></a>00686       ++i;
<a name="l00687"></a>00687     }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#ga100c5ce0696822c5a4cfbdfaba674d96" title="Appends a nul-terminated C-style string to a DBusString.">_dbus_string_append</a> (&amp;xml, <span class="stringliteral">&quot;&lt;/node&gt;\n&quot;</span>))
<a name="l00690"></a>00690     <span class="keywordflow">goto</span> out;
<a name="l00691"></a>00691 
<a name="l00692"></a>00692   reply = <a class="code" href="group__DBusMessage.html#ga95142bd8288f397194ee0eefb1d27125" title="Constructs a message that is a reply to a method call.">dbus_message_new_method_return</a> (message);
<a name="l00693"></a>00693   <span class="keywordflow">if</span> (reply == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00694"></a>00694     <span class="keywordflow">goto</span> out;
<a name="l00695"></a>00695 
<a name="l00696"></a>00696   <a class="code" href="group__DBusMessage.html#gaf733047c467ce21f4a53b65a388f1e9d" title="Initializes a DBusMessageIter for appending arguments to the end of a message.">dbus_message_iter_init_append</a> (reply, &amp;iter);
<a name="l00697"></a>00697   v_STRING = _dbus_string_get_const_data (&amp;xml);
<a name="l00698"></a>00698   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusMessage.html#ga17491f3b75b3203f6fc47dcc2e3b221b" title="Appends a basic-typed value to the message.">dbus_message_iter_append_basic</a> (&amp;iter, <a class="code" href="group__DBusProtocol.html#ga7eb77066dadf5415896b44c56d93acce" title="Type code marking a UTF-8 encoded, nul-terminated Unicode string.">DBUS_TYPE_STRING</a>, &amp;v_STRING))
<a name="l00699"></a>00699     <span class="keywordflow">goto</span> out;
<a name="l00700"></a>00700   
<a name="l00701"></a>00701 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00702"></a>00702 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00703"></a>00703 <span class="preprocessor">#endif</span>
<a name="l00704"></a>00704 <span class="preprocessor"></span>    {
<a name="l00705"></a>00705       already_unlocked = <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l00706"></a>00706       
<a name="l00707"></a>00707       <span class="keywordflow">if</span> (!<a class="code" href="group__DBusConnectionInternals.html#ga2974eb1c261305fafc635e14fc575d03" title="Like dbus_connection_send(), but assumes the connection is already locked on function entry...">_dbus_connection_send_and_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>, reply, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>))
<a name="l00708"></a>00708         <span class="keywordflow">goto</span> out;
<a name="l00709"></a>00709     }
<a name="l00710"></a>00710   
<a name="l00711"></a>00711   result = <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1deab6df40880a8f322694f14cd2804d3f76" title="Message has had its effect - no need to run more handlers.">DBUS_HANDLER_RESULT_HANDLED</a>;
<a name="l00712"></a>00712   
<a name="l00713"></a>00713  out:
<a name="l00714"></a>00714 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00715"></a>00715 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00716"></a>00716 <span class="preprocessor">#endif</span>
<a name="l00717"></a>00717 <span class="preprocessor"></span>    {
<a name="l00718"></a>00718       <span class="keywordflow">if</span> (!already_unlocked)
<a name="l00719"></a>00719         {
<a name="l00720"></a>00720           _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l00721"></a>00721           <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l00722"></a>00722         }
<a name="l00723"></a>00723     }
<a name="l00724"></a>00724   
<a name="l00725"></a>00725   <a class="code" href="group__DBusString.html#ga781ca91acda49a834dce7d0ed0eef212" title="Frees a string created by _dbus_string_init().">_dbus_string_free</a> (&amp;xml);
<a name="l00726"></a>00726   <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (children);
<a name="l00727"></a>00727   <span class="keywordflow">if</span> (reply)
<a name="l00728"></a>00728     <a class="code" href="group__DBusMessage.html#gab69441efe683918f6a82469c8763f464" title="Decrements the reference count of a DBusMessage, freeing the message if the count reaches 0...">dbus_message_unref</a> (reply);
<a name="l00729"></a>00729   
<a name="l00730"></a>00730   <span class="keywordflow">return</span> result;
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00746"></a>00746 <a class="code" href="group__DBusShared.html#ga8244b29230187624c24986c24edab1de" title="Results that a message handler can return.">DBusHandlerResult</a>
<a name="l00747"></a><a class="code" href="group__DBusObjectTree.html#gad660d78a12fa207d891838863dfc6ba7">00747</a> <a class="code" href="group__DBusObjectTree.html#gad660d78a12fa207d891838863dfc6ba7" title="Tries to dispatch a message by directing it to handler for the object path listed in the message head...">_dbus_object_tree_dispatch_and_unlock</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a>          *tree,
<a name="l00748"></a>00748                                        <a class="code" href="structDBusMessage.html" title="Internals of DBusMessage.">DBusMessage</a>             *message,
<a name="l00749"></a>00749                                        <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>             *found_object)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751   <span class="keywordtype">char</span> **path;
<a name="l00752"></a>00752   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> exact_match;
<a name="l00753"></a>00753   <a class="code" href="structDBusList.html" title="A node in a linked list.">DBusList</a> *list;
<a name="l00754"></a>00754   <a class="code" href="structDBusList.html" title="A node in a linked list.">DBusList</a> *link;
<a name="l00755"></a>00755   <a class="code" href="group__DBusShared.html#ga8244b29230187624c24986c24edab1de" title="Results that a message handler can return.">DBusHandlerResult</a> result;
<a name="l00756"></a>00756   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree;
<a name="l00757"></a>00757   
<a name="l00758"></a>00758 <span class="preprocessor">#if 0</span>
<a name="l00759"></a>00759 <span class="preprocessor"></span>  _dbus_verbose (<span class="stringliteral">&quot;Dispatch of message by object path\n&quot;</span>);
<a name="l00760"></a>00760 <span class="preprocessor">#endif</span>
<a name="l00761"></a>00761 <span class="preprocessor"></span>  
<a name="l00762"></a>00762   path = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00763"></a>00763   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusMessage.html#gaf2b5b3319da838b1f1b360c04a33f153" title="Gets the object path this message is being sent to (for DBUS_MESSAGE_TYPE_METHOD_CALL) or being emitt...">dbus_message_get_path_decomposed</a> (message, &amp;path))
<a name="l00764"></a>00764     {
<a name="l00765"></a>00765 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00766"></a>00766 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00767"></a>00767 <span class="preprocessor">#endif</span>
<a name="l00768"></a>00768 <span class="preprocessor"></span>        {
<a name="l00769"></a>00769           _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l00770"></a>00770           <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l00771"></a>00771         }
<a name="l00772"></a>00772       
<a name="l00773"></a>00773       _dbus_verbose (<span class="stringliteral">&quot;No memory to get decomposed path\n&quot;</span>);
<a name="l00774"></a>00774 
<a name="l00775"></a>00775       <span class="keywordflow">return</span> <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1dea01f00ce4578559c7b14b91256bfede7d" title="Need more memory in order to return DBUS_HANDLER_RESULT_HANDLED or DBUS_HANDLER_RESULT_NOT_YET_HANDLE...">DBUS_HANDLER_RESULT_NEED_MEMORY</a>;
<a name="l00776"></a>00776     }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778   <span class="keywordflow">if</span> (path == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00779"></a>00779     {
<a name="l00780"></a>00780 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00781"></a>00781 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00782"></a>00782 <span class="preprocessor">#endif</span>
<a name="l00783"></a>00783 <span class="preprocessor"></span>        {
<a name="l00784"></a>00784           _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l00785"></a>00785           <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l00786"></a>00786         }
<a name="l00787"></a>00787       
<a name="l00788"></a>00788       _dbus_verbose (<span class="stringliteral">&quot;No path field in message\n&quot;</span>);
<a name="l00789"></a>00789       <span class="keywordflow">return</span> <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1deacb84b64c92055f2585fe9c29f1e5df68" title="Message has not had any effect - see if other handlers want it.">DBUS_HANDLER_RESULT_NOT_YET_HANDLED</a>;
<a name="l00790"></a>00790     }
<a name="l00791"></a>00791   
<a name="l00792"></a>00792   <span class="comment">/* Find the deepest path that covers the path in the message */</span>
<a name="l00793"></a>00793   subtree = find_handler (tree, (<span class="keyword">const</span> <span class="keywordtype">char</span>**) path, &amp;exact_match);
<a name="l00794"></a>00794   
<a name="l00795"></a>00795   <span class="keywordflow">if</span> (found_object)
<a name="l00796"></a>00796     *found_object = !!subtree;
<a name="l00797"></a>00797 
<a name="l00798"></a>00798   <span class="comment">/* Build a list of all paths that cover the path in the message */</span>
<a name="l00799"></a>00799 
<a name="l00800"></a>00800   list = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802   <span class="keywordflow">while</span> (subtree != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00803"></a>00803     {
<a name="l00804"></a>00804       <span class="keywordflow">if</span> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> &amp;&amp; (exact_match || subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ab29370bdbfa87f8e6f718a3f4a20b652" title="Whether to invoke message_function when child nodes don&#39;t handle the message.">invoke_as_fallback</a>))
<a name="l00805"></a>00805         {
<a name="l00806"></a>00806           _dbus_object_subtree_ref (subtree);
<a name="l00807"></a>00807 
<a name="l00808"></a>00808           <span class="comment">/* run deepest paths first */</span>
<a name="l00809"></a>00809           <span class="keywordflow">if</span> (!<a class="code" href="group__DBusList.html#gad99045e79db46159babe69718f343053" title="Appends a value to the list.">_dbus_list_append</a> (&amp;list, subtree))
<a name="l00810"></a>00810             {
<a name="l00811"></a>00811               result = <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1dea01f00ce4578559c7b14b91256bfede7d" title="Need more memory in order to return DBUS_HANDLER_RESULT_HANDLED or DBUS_HANDLER_RESULT_NOT_YET_HANDLE...">DBUS_HANDLER_RESULT_NEED_MEMORY</a>;
<a name="l00812"></a>00812               _dbus_object_subtree_unref (subtree);
<a name="l00813"></a>00813               <span class="keywordflow">goto</span> free_and_return;
<a name="l00814"></a>00814             }
<a name="l00815"></a>00815         }
<a name="l00816"></a>00816 
<a name="l00817"></a>00817       exact_match = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l00818"></a>00818       subtree = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a>;
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820 
<a name="l00821"></a>00821   _dbus_verbose (<span class="stringliteral">&quot;%d handlers in the path tree for this message\n&quot;</span>,
<a name="l00822"></a>00822                  <a class="code" href="group__DBusList.html#gaa2144a5489bb35b16b2b671488ad597c" title="Gets the length of a list.">_dbus_list_get_length</a> (&amp;list));
<a name="l00823"></a>00823 
<a name="l00824"></a>00824   <span class="comment">/* Invoke each handler in the list */</span>
<a name="l00825"></a>00825 
<a name="l00826"></a>00826   result = <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1deacb84b64c92055f2585fe9c29f1e5df68" title="Message has not had any effect - see if other handlers want it.">DBUS_HANDLER_RESULT_NOT_YET_HANDLED</a>;
<a name="l00827"></a>00827 
<a name="l00828"></a>00828   link = <a class="code" href="group__DBusList.html#ga1e26ce4fb4acb50593bd5ed2f4eeb3ae" title="Gets the first link in the list.">_dbus_list_get_first_link</a> (&amp;list);
<a name="l00829"></a>00829   <span class="keywordflow">while</span> (link != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00830"></a>00830     {
<a name="l00831"></a>00831       <a class="code" href="structDBusList.html" title="A node in a linked list.">DBusList</a> *next = <a class="code" href="group__DBusList.html#gaede4ace46d5ee497d75074bfec4490a2" title="Gets the next link in the list, or NULL if there are no more links.">_dbus_list_get_next_link</a> (&amp;list, link);
<a name="l00832"></a>00832       subtree = link-&gt;<a class="code" href="structDBusList.html#a29ab457bcf9092252bb0c4282c727055" title="Data stored at this element.">data</a>;
<a name="l00833"></a>00833 
<a name="l00834"></a>00834       <span class="comment">/* message_function is NULL if we&#39;re unregistered</span>
<a name="l00835"></a>00835 <span class="comment">       * due to reentrancy</span>
<a name="l00836"></a>00836 <span class="comment">       */</span>
<a name="l00837"></a>00837       <span class="keywordflow">if</span> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a>)
<a name="l00838"></a>00838         {
<a name="l00839"></a>00839           <a class="code" href="group__DBusConnection.html#ga348e43a15f8f2bc5b88651b70ec8dbdd" title="Called when a message is sent to a registered object path.">DBusObjectPathMessageFunction</a> message_function;
<a name="l00840"></a>00840           <span class="keywordtype">void</span> *user_data;
<a name="l00841"></a>00841 
<a name="l00842"></a>00842           message_function = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a>;
<a name="l00843"></a>00843           user_data = subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a>;
<a name="l00844"></a>00844 
<a name="l00845"></a>00845 <span class="preprocessor">#if 0</span>
<a name="l00846"></a>00846 <span class="preprocessor"></span>          _dbus_verbose (<span class="stringliteral">&quot;  (invoking a handler)\n&quot;</span>);
<a name="l00847"></a>00847 <span class="preprocessor">#endif</span>
<a name="l00848"></a>00848 <span class="preprocessor"></span>          
<a name="l00849"></a>00849 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00850"></a>00850 <span class="preprocessor"></span>          <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00851"></a>00851 <span class="preprocessor">#endif</span>
<a name="l00852"></a>00852 <span class="preprocessor"></span>            {
<a name="l00853"></a>00853               _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l00854"></a>00854               <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l00855"></a>00855             }
<a name="l00856"></a>00856 
<a name="l00857"></a>00857           <span class="comment">/* FIXME you could unregister the subtree in another thread</span>
<a name="l00858"></a>00858 <span class="comment">           * before we invoke the callback, and I can&#39;t figure out a</span>
<a name="l00859"></a>00859 <span class="comment">           * good way to solve this.</span>
<a name="l00860"></a>00860 <span class="comment">           */</span>
<a name="l00861"></a>00861 
<a name="l00862"></a>00862           result = (* message_function) (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>,
<a name="l00863"></a>00863                                          message,
<a name="l00864"></a>00864                                          user_data);
<a name="l00865"></a>00865 
<a name="l00866"></a>00866 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00867"></a>00867 <span class="preprocessor"></span>          <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00868"></a>00868 <span class="preprocessor">#endif</span>
<a name="l00869"></a>00869 <span class="preprocessor"></span>            <a class="code" href="group__DBusConnectionInternals.html#ga4fe0c8f7b72dc89b9e1a3110db2f778e" title="Acquires the connection lock.">_dbus_connection_lock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l00870"></a>00870 
<a name="l00871"></a>00871           <span class="keywordflow">if</span> (result != <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1deacb84b64c92055f2585fe9c29f1e5df68" title="Message has not had any effect - see if other handlers want it.">DBUS_HANDLER_RESULT_NOT_YET_HANDLED</a>)
<a name="l00872"></a>00872             <span class="keywordflow">goto</span> free_and_return;
<a name="l00873"></a>00873         }
<a name="l00874"></a>00874 
<a name="l00875"></a>00875       link = next;
<a name="l00876"></a>00876     }
<a name="l00877"></a>00877 
<a name="l00878"></a>00878  free_and_return:
<a name="l00879"></a>00879 
<a name="l00880"></a>00880   <span class="keywordflow">if</span> (result == <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1deacb84b64c92055f2585fe9c29f1e5df68" title="Message has not had any effect - see if other handlers want it.">DBUS_HANDLER_RESULT_NOT_YET_HANDLED</a>)
<a name="l00881"></a>00881     {
<a name="l00882"></a>00882       <span class="comment">/* This hardcoded default handler does a minimal Introspect()</span>
<a name="l00883"></a>00883 <span class="comment">       */</span>
<a name="l00884"></a>00884       result = handle_default_introspect_and_unlock (tree, message,
<a name="l00885"></a>00885                                                      (<span class="keyword">const</span> <span class="keywordtype">char</span>**) path);
<a name="l00886"></a>00886     }
<a name="l00887"></a>00887   <span class="keywordflow">else</span>
<a name="l00888"></a>00888     {
<a name="l00889"></a>00889 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l00890"></a>00890 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l00891"></a>00891 <span class="preprocessor">#endif</span>
<a name="l00892"></a>00892 <span class="preprocessor"></span>        {
<a name="l00893"></a>00893           _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l00894"></a>00894           <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l00895"></a>00895         }
<a name="l00896"></a>00896     }
<a name="l00897"></a>00897   
<a name="l00898"></a>00898   <span class="keywordflow">while</span> (list != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00899"></a>00899     {
<a name="l00900"></a>00900       link = <a class="code" href="group__DBusList.html#ga1e26ce4fb4acb50593bd5ed2f4eeb3ae" title="Gets the first link in the list.">_dbus_list_get_first_link</a> (&amp;list);
<a name="l00901"></a>00901       _dbus_object_subtree_unref (link-&gt;<a class="code" href="structDBusList.html#a29ab457bcf9092252bb0c4282c727055" title="Data stored at this element.">data</a>);
<a name="l00902"></a>00902       <a class="code" href="group__DBusList.html#ga40abea762d9cb44e5ec6b31b1769dc2e" title="Removes a link from the list.">_dbus_list_remove_link</a> (&amp;list, link);
<a name="l00903"></a>00903     }
<a name="l00904"></a>00904   
<a name="l00905"></a>00905   <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (path);
<a name="l00906"></a>00906 
<a name="l00907"></a>00907   <span class="keywordflow">return</span> result;
<a name="l00908"></a>00908 }
<a name="l00909"></a>00909 
<a name="l00918"></a>00918 <span class="keywordtype">void</span>*
<a name="l00919"></a><a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4">00919</a> <a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l00920"></a>00920                                           <span class="keyword">const</span> <span class="keywordtype">char</span>    **path)
<a name="l00921"></a>00921 {
<a name="l00922"></a>00922   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> exact_match;
<a name="l00923"></a>00923   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree;
<a name="l00924"></a>00924 
<a name="l00925"></a>00925   _dbus_assert (tree != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00926"></a>00926   _dbus_assert (path != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00927"></a>00927   
<a name="l00928"></a>00928   <span class="comment">/* Find the deepest path that covers the path in the message */</span>
<a name="l00929"></a>00929   subtree = find_handler (tree, (<span class="keyword">const</span> <span class="keywordtype">char</span>**) path, &amp;exact_match);
<a name="l00930"></a>00930 
<a name="l00931"></a>00931   <span class="keywordflow">if</span> ((subtree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>) || !exact_match)
<a name="l00932"></a>00932     {
<a name="l00933"></a>00933       _dbus_verbose (<span class="stringliteral">&quot;No object at specified path found\n&quot;</span>);
<a name="l00934"></a>00934       <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936 
<a name="l00937"></a>00937   <span class="keywordflow">return</span> subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a>;
<a name="l00938"></a>00938 }
<a name="l00939"></a>00939 
<a name="l00946"></a>00946 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>*
<a name="l00947"></a>00947 allocate_subtree_object (<span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00948"></a>00948 {
<a name="l00949"></a>00949   <span class="keywordtype">int</span> len;
<a name="l00950"></a>00950   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree;
<a name="l00951"></a>00951   <span class="keyword">const</span> <span class="keywordtype">size_t</span> front_padding = _DBUS_STRUCT_OFFSET (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>, name);
<a name="l00952"></a>00952 
<a name="l00953"></a>00953   _dbus_assert (name != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00954"></a>00954 
<a name="l00955"></a>00955   len = strlen (name);
<a name="l00956"></a>00956 
<a name="l00957"></a>00957   subtree = <a class="code" href="group__DBusMemory.html#gaa02722b030a091f6c14c4cb11a593623" title="Allocates the given number of bytes, as with standard malloc(), but all bytes are initialized to zero...">dbus_malloc0</a> (MAX (front_padding + (len + 1), <span class="keyword">sizeof</span> (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>)));
<a name="l00958"></a>00958 
<a name="l00959"></a>00959   <span class="keywordflow">if</span> (subtree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00960"></a>00960     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00961"></a>00961 
<a name="l00962"></a>00962   memcpy (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>, name, len + 1);
<a name="l00963"></a>00963 
<a name="l00964"></a>00964   <span class="keywordflow">return</span> subtree;
<a name="l00965"></a>00965 }
<a name="l00966"></a>00966 
<a name="l00967"></a>00967 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a>*
<a name="l00968"></a>00968 _dbus_object_subtree_new (<span class="keyword">const</span> <span class="keywordtype">char</span>                  *name,
<a name="l00969"></a>00969                           <span class="keyword">const</span> <a class="code" href="structDBusObjectPathVTable.html" title="Virtual table that must be implemented to handle a portion of the object path hierarchy.">DBusObjectPathVTable</a>  *vtable,
<a name="l00970"></a>00970                           <span class="keywordtype">void</span>                        *user_data)
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972   <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree;
<a name="l00973"></a>00973 
<a name="l00974"></a>00974   subtree = allocate_subtree_object (name);
<a name="l00975"></a>00975   <span class="keywordflow">if</span> (subtree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l00976"></a>00976     <span class="keywordflow">goto</span> oom;
<a name="l00977"></a>00977 
<a name="l00978"></a>00978   _dbus_assert (name != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l00979"></a>00979 
<a name="l00980"></a>00980   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a352044a5ca8e29df149b248b0d988d96" title="Parent node.">parent</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00981"></a>00981 
<a name="l00982"></a>00982   <span class="keywordflow">if</span> (vtable)
<a name="l00983"></a>00983     {
<a name="l00984"></a>00984       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> = vtable-&gt;<a class="code" href="structDBusObjectPathVTable.html#a83464b6b8b66fb7adebd8e3bf8ff1b70" title="Function to handle messages.">message_function</a>;
<a name="l00985"></a>00985       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a> = vtable-&gt;<a class="code" href="structDBusObjectPathVTable.html#abb6c084f345051b9649615b91ec654d4" title="Function to unregister this handler.">unregister_function</a>;
<a name="l00986"></a>00986     }
<a name="l00987"></a>00987   <span class="keywordflow">else</span>
<a name="l00988"></a>00988     {
<a name="l00989"></a>00989       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00990"></a>00990       subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00991"></a>00991     }
<a name="l00992"></a>00992 
<a name="l00993"></a>00993   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac879ddd02ff982b7ba6d014562b85807" title="Data for functions.">user_data</a> = user_data;
<a name="l00994"></a>00994   <a class="code" href="group__DBusSysdeps.html#gae74c3fcf12acaeccdb152ef907de951c" title="Atomically increments an integer.">_dbus_atomic_inc</a> (&amp;subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a45c6566f866ca45d48817f64f7f08fa6" title="Reference count.">refcount</a>);
<a name="l00995"></a>00995   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a> = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l00996"></a>00996   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a> = 0;
<a name="l00997"></a>00997   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ac5be3a80fa3547cea2ac7535865123c7" title="Number of allocated entries in subtrees.">max_subtrees</a> = 0;
<a name="l00998"></a>00998   subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ab29370bdbfa87f8e6f718a3f4a20b652" title="Whether to invoke message_function when child nodes don&#39;t handle the message.">invoke_as_fallback</a> = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l00999"></a>00999 
<a name="l01000"></a>01000   <span class="keywordflow">return</span> subtree;
<a name="l01001"></a>01001 
<a name="l01002"></a>01002  oom:
<a name="l01003"></a>01003   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l01004"></a>01004 }
<a name="l01005"></a>01005 
<a name="l01006"></a>01006 <span class="keyword">static</span> <a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *
<a name="l01007"></a>01007 _dbus_object_subtree_ref (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree)
<a name="l01008"></a>01008 {
<a name="l01009"></a>01009 <span class="preprocessor">#ifdef DBUS_DISABLE_ASSERT</span>
<a name="l01010"></a>01010 <span class="preprocessor"></span>  <a class="code" href="group__DBusSysdeps.html#gae74c3fcf12acaeccdb152ef907de951c" title="Atomically increments an integer.">_dbus_atomic_inc</a> (&amp;subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a45c6566f866ca45d48817f64f7f08fa6" title="Reference count.">refcount</a>);
<a name="l01011"></a>01011 <span class="preprocessor">#else</span>
<a name="l01012"></a>01012 <span class="preprocessor"></span>  dbus_int32_t old_value;
<a name="l01013"></a>01013 
<a name="l01014"></a>01014   old_value = <a class="code" href="group__DBusSysdeps.html#gae74c3fcf12acaeccdb152ef907de951c" title="Atomically increments an integer.">_dbus_atomic_inc</a> (&amp;subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a45c6566f866ca45d48817f64f7f08fa6" title="Reference count.">refcount</a>);
<a name="l01015"></a>01015   _dbus_assert (old_value &gt; 0);
<a name="l01016"></a>01016 <span class="preprocessor">#endif</span>
<a name="l01017"></a>01017 <span class="preprocessor"></span>
<a name="l01018"></a>01018   <span class="keywordflow">return</span> subtree;
<a name="l01019"></a>01019 }
<a name="l01020"></a>01020 
<a name="l01021"></a>01021 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01022"></a>01022 _dbus_object_subtree_unref (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree)
<a name="l01023"></a>01023 {
<a name="l01024"></a>01024   dbus_int32_t old_value;
<a name="l01025"></a>01025 
<a name="l01026"></a>01026   old_value = <a class="code" href="group__DBusSysdeps.html#ga3c50a069f795dceeb9172fe2b517bbdc" title="Atomically decrement an integer.">_dbus_atomic_dec</a> (&amp;subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a45c6566f866ca45d48817f64f7f08fa6" title="Reference count.">refcount</a>);
<a name="l01027"></a>01027   _dbus_assert (old_value &gt; 0);
<a name="l01028"></a>01028 
<a name="l01029"></a>01029   <span class="keywordflow">if</span> (old_value == 1)
<a name="l01030"></a>01030     {
<a name="l01031"></a>01031       _dbus_assert (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a7038595dfd005eeb9a9e2dad07cdc9c6" title="Function to call on unregister.">unregister_function</a> == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01032"></a>01032       _dbus_assert (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a6be63f07c500936dde058024ccbd30d4" title="Function to handle messages.">message_function</a> == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01033"></a>01033 
<a name="l01034"></a>01034       <a class="code" href="group__DBusMemory.html#ga34e666b19b015035a9a31e53da84b39a" title="Frees a block of memory previously allocated by dbus_malloc() or dbus_malloc0().">dbus_free</a> (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>);
<a name="l01035"></a>01035       <a class="code" href="group__DBusMemory.html#ga34e666b19b015035a9a31e53da84b39a" title="Frees a block of memory previously allocated by dbus_malloc() or dbus_malloc0().">dbus_free</a> (subtree);
<a name="l01036"></a>01036     }
<a name="l01037"></a>01037 }
<a name="l01038"></a>01038 
<a name="l01049"></a>01049 <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l01050"></a><a class="code" href="group__DBusObjectTree.html#gaab7040bd1bf037d99e9bbb75d0869a2f">01050</a> <a class="code" href="group__DBusObjectTree.html#gaab7040bd1bf037d99e9bbb75d0869a2f" title="Lists the registered fallback handlers and object path handlers at the given parent_path.">_dbus_object_tree_list_registered_and_unlock</a> (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l01051"></a>01051                                               <span class="keyword">const</span> <span class="keywordtype">char</span>    **parent_path,
<a name="l01052"></a>01052                                               <span class="keywordtype">char</span>         ***child_entries)
<a name="l01053"></a>01053 {
<a name="l01054"></a>01054   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> result;
<a name="l01055"></a>01055 
<a name="l01056"></a>01056   result = _dbus_object_tree_list_registered_unlocked (tree,
<a name="l01057"></a>01057                                                        parent_path,
<a name="l01058"></a>01058                                                        child_entries);
<a name="l01059"></a>01059   
<a name="l01060"></a>01060 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l01061"></a>01061 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>)
<a name="l01062"></a>01062 <span class="preprocessor">#endif</span>
<a name="l01063"></a>01063 <span class="preprocessor"></span>    {
<a name="l01064"></a>01064       _dbus_verbose (<span class="stringliteral">&quot;unlock\n&quot;</span>);
<a name="l01065"></a>01065       <a class="code" href="group__DBusConnectionInternals.html#ga3db10d48ec16e485d5a638aacebd4ad2" title="Releases the connection lock.">_dbus_connection_unlock</a> (tree-&gt;<a class="code" href="structDBusObjectTree.html#a65b58bdaad2e5d09d8366d286e46b100" title="Connection this tree belongs to.">connection</a>);
<a name="l01066"></a>01066     }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068   <span class="keywordflow">return</span> result;
<a name="l01069"></a>01069 }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071 
<a name="l01073"></a><a class="code" href="group__DBusObjectTree.html#ga9def2cd95c325a4ad26222cddbfed5d5">01073</a> <span class="preprocessor">#define VERBOSE_DECOMPOSE 0</span>
<a name="l01074"></a>01074 <span class="preprocessor"></span>
<a name="l01085"></a>01085 <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l01086"></a><a class="code" href="group__DBusObjectTree.html#gab282b916368cd512842d3aaae31e65c7">01086</a> <a class="code" href="group__DBusObjectTree.html#gab282b916368cd512842d3aaae31e65c7" title="Decompose an object path.">_dbus_decompose_path</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>*     data,
<a name="l01087"></a>01087                       <span class="keywordtype">int</span>             len,
<a name="l01088"></a>01088                       <span class="keywordtype">char</span>         ***path,
<a name="l01089"></a>01089                       <span class="keywordtype">int</span>            *path_len)
<a name="l01090"></a>01090 {
<a name="l01091"></a>01091   <span class="keywordtype">char</span> **retval;
<a name="l01092"></a>01092   <span class="keywordtype">int</span> n_components;
<a name="l01093"></a>01093   <span class="keywordtype">int</span> i, j, comp;
<a name="l01094"></a>01094 
<a name="l01095"></a>01095   _dbus_assert (data != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01096"></a>01096   _dbus_assert (path != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01097"></a>01097   
<a name="l01098"></a>01098 <span class="preprocessor">#if VERBOSE_DECOMPOSE</span>
<a name="l01099"></a>01099 <span class="preprocessor"></span>  _dbus_verbose (<span class="stringliteral">&quot;Decomposing path \&quot;%s\&quot;\n&quot;</span>,
<a name="l01100"></a>01100                  data);
<a name="l01101"></a>01101 <span class="preprocessor">#endif</span>
<a name="l01102"></a>01102 <span class="preprocessor"></span>  
<a name="l01103"></a>01103   n_components = 0;
<a name="l01104"></a>01104   <span class="keywordflow">if</span> (len &gt; 1) <span class="comment">/* if path is not just &quot;/&quot; */</span>
<a name="l01105"></a>01105     {
<a name="l01106"></a>01106       i = 0;
<a name="l01107"></a>01107       <span class="keywordflow">while</span> (i &lt; len)
<a name="l01108"></a>01108         {
<a name="l01109"></a>01109           _dbus_assert (data[i] != <span class="charliteral">&#39;\0&#39;</span>);
<a name="l01110"></a>01110           <span class="keywordflow">if</span> (data[i] == <span class="charliteral">&#39;/&#39;</span>)
<a name="l01111"></a>01111             n_components += 1;
<a name="l01112"></a>01112           ++i;
<a name="l01113"></a>01113         }
<a name="l01114"></a>01114     }
<a name="l01115"></a>01115   
<a name="l01116"></a>01116   retval = <a class="code" href="group__DBusMemory.html#gaba9d823abda7f4cadbaf5177d3b8b793" title="Safe macro for using dbus_malloc0().">dbus_new0</a> (<span class="keywordtype">char</span>*, n_components + 1);
<a name="l01117"></a>01117 
<a name="l01118"></a>01118   <span class="keywordflow">if</span> (retval == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01119"></a>01119     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01120"></a>01120 
<a name="l01121"></a>01121   comp = 0;
<a name="l01122"></a>01122   <span class="keywordflow">if</span> (n_components == 0)
<a name="l01123"></a>01123     i = 1;
<a name="l01124"></a>01124   <span class="keywordflow">else</span>
<a name="l01125"></a>01125     i = 0;
<a name="l01126"></a>01126   <span class="keywordflow">while</span> (comp &lt; n_components)
<a name="l01127"></a>01127     {
<a name="l01128"></a>01128       _dbus_assert (i &lt; len);
<a name="l01129"></a>01129       
<a name="l01130"></a>01130       <span class="keywordflow">if</span> (data[i] == <span class="charliteral">&#39;/&#39;</span>)
<a name="l01131"></a>01131         ++i;
<a name="l01132"></a>01132       j = i;
<a name="l01133"></a>01133 
<a name="l01134"></a>01134       <span class="keywordflow">while</span> (j &lt; len &amp;&amp; data[j] != <span class="charliteral">&#39;/&#39;</span>)
<a name="l01135"></a>01135         ++j;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137       <span class="comment">/* Now [i, j) is the path component */</span>
<a name="l01138"></a>01138       _dbus_assert (i &lt; j);
<a name="l01139"></a>01139       _dbus_assert (data[i] != <span class="charliteral">&#39;/&#39;</span>);
<a name="l01140"></a>01140       _dbus_assert (j == len || data[j] == <span class="charliteral">&#39;/&#39;</span>);
<a name="l01141"></a>01141 
<a name="l01142"></a>01142 <span class="preprocessor">#if VERBOSE_DECOMPOSE</span>
<a name="l01143"></a>01143 <span class="preprocessor"></span>      _dbus_verbose (<span class="stringliteral">&quot;  (component in [%d,%d))\n&quot;</span>,
<a name="l01144"></a>01144                      i, j);
<a name="l01145"></a>01145 <span class="preprocessor">#endif</span>
<a name="l01146"></a>01146 <span class="preprocessor"></span>      
<a name="l01147"></a>01147       retval[comp] = <a class="code" href="group__DBusInternalsUtils.html#gaad95864dca5140b730bc143cb2d1b024" title="Duplicates a block of memory.">_dbus_memdup</a> (&amp;data[i], j - i + 1);
<a name="l01148"></a>01148       <span class="keywordflow">if</span> (retval[comp] == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01149"></a>01149         {
<a name="l01150"></a>01150           <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (retval);
<a name="l01151"></a>01151           <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01152"></a>01152         }
<a name="l01153"></a>01153       retval[comp][j-i] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l01154"></a>01154 <span class="preprocessor">#if VERBOSE_DECOMPOSE</span>
<a name="l01155"></a>01155 <span class="preprocessor"></span>      _dbus_verbose (<span class="stringliteral">&quot;  (component %d = \&quot;%s\&quot;)\n&quot;</span>,
<a name="l01156"></a>01156                      comp, retval[comp]);
<a name="l01157"></a>01157 <span class="preprocessor">#endif</span>
<a name="l01158"></a>01158 <span class="preprocessor"></span>
<a name="l01159"></a>01159       ++comp;
<a name="l01160"></a>01160       i = j;
<a name="l01161"></a>01161     }
<a name="l01162"></a>01162   _dbus_assert (i == len);
<a name="l01163"></a>01163   
<a name="l01164"></a>01164   *path = retval;
<a name="l01165"></a>01165   <span class="keywordflow">if</span> (path_len)
<a name="l01166"></a>01166     *path_len = n_components;
<a name="l01167"></a>01167   
<a name="l01168"></a>01168   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l01169"></a>01169 }
<a name="l01170"></a>01170 
<a name="l01173"></a>01173 <span class="keyword">static</span> <span class="keywordtype">char</span>*
<a name="l01174"></a>01174 flatten_path (<span class="keyword">const</span> <span class="keywordtype">char</span> **path)
<a name="l01175"></a>01175 {
<a name="l01176"></a>01176   <a class="code" href="structDBusString.html">DBusString</a> str;
<a name="l01177"></a>01177   <span class="keywordtype">char</span> *s;
<a name="l01178"></a>01178 
<a name="l01179"></a>01179   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#ga348252317f7bb8ac43529972945830ae" title="Initializes a string.">_dbus_string_init</a> (&amp;str))
<a name="l01180"></a>01180     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l01181"></a>01181 
<a name="l01182"></a>01182   <span class="keywordflow">if</span> (path[0] == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01183"></a>01183     {
<a name="l01184"></a>01184       <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#gaa6ecf36e70263659f921a4ef0335db12" title="Appends a single byte to the string, returning FALSE if not enough memory.">_dbus_string_append_byte</a> (&amp;str, <span class="charliteral">&#39;/&#39;</span>))
<a name="l01185"></a>01185         <span class="keywordflow">goto</span> nomem;
<a name="l01186"></a>01186     }
<a name="l01187"></a>01187   <span class="keywordflow">else</span>
<a name="l01188"></a>01188     {
<a name="l01189"></a>01189       <span class="keywordtype">int</span> i;
<a name="l01190"></a>01190       
<a name="l01191"></a>01191       i = 0;
<a name="l01192"></a>01192       <span class="keywordflow">while</span> (path[i])
<a name="l01193"></a>01193         {
<a name="l01194"></a>01194           <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#gaa6ecf36e70263659f921a4ef0335db12" title="Appends a single byte to the string, returning FALSE if not enough memory.">_dbus_string_append_byte</a> (&amp;str, <span class="charliteral">&#39;/&#39;</span>))
<a name="l01195"></a>01195             <span class="keywordflow">goto</span> nomem;
<a name="l01196"></a>01196           
<a name="l01197"></a>01197           <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#ga100c5ce0696822c5a4cfbdfaba674d96" title="Appends a nul-terminated C-style string to a DBusString.">_dbus_string_append</a> (&amp;str, path[i]))
<a name="l01198"></a>01198             <span class="keywordflow">goto</span> nomem;
<a name="l01199"></a>01199           
<a name="l01200"></a>01200           ++i;
<a name="l01201"></a>01201         }
<a name="l01202"></a>01202     }
<a name="l01203"></a>01203 
<a name="l01204"></a>01204   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusString.html#ga556cc30c3ab032dbc63e217119f0d1f5" title="Like _dbus_string_get_data(), but removes the gotten data from the original string.">_dbus_string_steal_data</a> (&amp;str, &amp;s))
<a name="l01205"></a>01205     <span class="keywordflow">goto</span> nomem;
<a name="l01206"></a>01206 
<a name="l01207"></a>01207   <a class="code" href="group__DBusString.html#ga781ca91acda49a834dce7d0ed0eef212" title="Frees a string created by _dbus_string_init().">_dbus_string_free</a> (&amp;str);
<a name="l01208"></a>01208 
<a name="l01209"></a>01209   <span class="keywordflow">return</span> s;
<a name="l01210"></a>01210 
<a name="l01211"></a>01211  nomem:
<a name="l01212"></a>01212   <a class="code" href="group__DBusString.html#ga781ca91acda49a834dce7d0ed0eef212" title="Frees a string created by _dbus_string_init().">_dbus_string_free</a> (&amp;str);
<a name="l01213"></a>01213   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l01214"></a>01214 }
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 
<a name="l01217"></a>01217 <span class="preprocessor">#ifdef DBUS_BUILD_TESTS</span>
<a name="l01218"></a>01218 <span class="preprocessor"></span>
<a name="l01219"></a>01219 <span class="preprocessor">#ifndef DOXYGEN_SHOULD_SKIP_THIS</span>
<a name="l01220"></a>01220 <span class="preprocessor"></span>
<a name="l01221"></a>01221 <span class="preprocessor">#include &quot;dbus-test.h&quot;</span>
<a name="l01222"></a>01222 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l01223"></a>01223 
<a name="l01224"></a>01224 <span class="keyword">typedef</span> <span class="keyword">enum</span> 
<a name="l01225"></a>01225 {
<a name="l01226"></a>01226   STR_EQUAL,
<a name="l01227"></a>01227   STR_PREFIX,
<a name="l01228"></a>01228   STR_DIFFERENT
<a name="l01229"></a>01229 } StrComparison;
<a name="l01230"></a>01230 
<a name="l01231"></a>01231 <span class="comment">/* Returns TRUE if container is a parent of child</span>
<a name="l01232"></a>01232 <span class="comment"> */</span>
<a name="l01233"></a>01233 <span class="keyword">static</span> StrComparison
<a name="l01234"></a>01234 path_contains (<span class="keyword">const</span> <span class="keywordtype">char</span> **container,
<a name="l01235"></a>01235                <span class="keyword">const</span> <span class="keywordtype">char</span> **child)
<a name="l01236"></a>01236 {
<a name="l01237"></a>01237   <span class="keywordtype">int</span> i;
<a name="l01238"></a>01238 
<a name="l01239"></a>01239   i = 0;
<a name="l01240"></a>01240   <span class="keywordflow">while</span> (child[i] != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01241"></a>01241     {
<a name="l01242"></a>01242       <span class="keywordtype">int</span> v;
<a name="l01243"></a>01243 
<a name="l01244"></a>01244       <span class="keywordflow">if</span> (container[i] == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01245"></a>01245         <span class="keywordflow">return</span> STR_PREFIX; <span class="comment">/* container ran out, child continues;</span>
<a name="l01246"></a>01246 <span class="comment">                            * thus the container is a parent of the</span>
<a name="l01247"></a>01247 <span class="comment">                            * child.</span>
<a name="l01248"></a>01248 <span class="comment">                            */</span>
<a name="l01249"></a>01249 
<a name="l01250"></a>01250       _dbus_assert (container[i] != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01251"></a>01251       _dbus_assert (child[i] != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01252"></a>01252 
<a name="l01253"></a>01253       v = strcmp (container[i], child[i]);
<a name="l01254"></a>01254 
<a name="l01255"></a>01255       <span class="keywordflow">if</span> (v != 0)
<a name="l01256"></a>01256         <span class="keywordflow">return</span> STR_DIFFERENT; <span class="comment">/* they overlap until here and then are different,</span>
<a name="l01257"></a>01257 <span class="comment">                               * not overlapping</span>
<a name="l01258"></a>01258 <span class="comment">                               */</span>
<a name="l01259"></a>01259 
<a name="l01260"></a>01260       ++i;
<a name="l01261"></a>01261     }
<a name="l01262"></a>01262 
<a name="l01263"></a>01263   <span class="comment">/* Child ran out; if container also did, they are equal;</span>
<a name="l01264"></a>01264 <span class="comment">   * otherwise, the child is a parent of the container.</span>
<a name="l01265"></a>01265 <span class="comment">   */</span>
<a name="l01266"></a>01266   <span class="keywordflow">if</span> (container[i] == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01267"></a>01267     <span class="keywordflow">return</span> STR_EQUAL;
<a name="l01268"></a>01268   <span class="keywordflow">else</span>
<a name="l01269"></a>01269     <span class="keywordflow">return</span> STR_DIFFERENT;
<a name="l01270"></a>01270 }
<a name="l01271"></a>01271 
<a name="l01272"></a>01272 <span class="preprocessor">#if 0</span>
<a name="l01273"></a>01273 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01274"></a>01274 spew_subtree_recurse (<a class="code" href="structDBusObjectSubtree.html" title="Struct representing a single registered subtree handler, or node that&#39;s a parent of a registered subt...">DBusObjectSubtree</a> *subtree,
<a name="l01275"></a>01275                       <span class="keywordtype">int</span>                indent)
<a name="l01276"></a>01276 {
<a name="l01277"></a>01277   <span class="keywordtype">int</span> i;
<a name="l01278"></a>01278 
<a name="l01279"></a>01279   i = 0;
<a name="l01280"></a>01280   <span class="keywordflow">while</span> (i &lt; indent)
<a name="l01281"></a>01281     {
<a name="l01282"></a>01282       _dbus_verbose (<span class="stringliteral">&quot; &quot;</span>);
<a name="l01283"></a>01283       ++i;
<a name="l01284"></a>01284     }
<a name="l01285"></a>01285 
<a name="l01286"></a>01286   _dbus_verbose (<span class="stringliteral">&quot;%s (%d children)\n&quot;</span>,
<a name="l01287"></a>01287                  subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#add05785d7c8572e28254c47d50a3c914" title="Allocated as large as necessary.">name</a>, subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#a9972c279dd920fc5b69fc63886c880ed" title="Number of child nodes.">n_subtrees</a>);
<a name="l01288"></a>01288 
<a name="l01289"></a>01289   i = 0;
<a name="l01290"></a>01290   <span class="keywordflow">while</span> (i &lt; subtree-&gt;n_subtrees)
<a name="l01291"></a>01291     {
<a name="l01292"></a>01292       spew_subtree_recurse (subtree-&gt;<a class="code" href="structDBusObjectSubtree.html#ade77f6089c08d212eda0b4223ab66915" title="Child nodes.">subtrees</a>[i], indent + 2);
<a name="l01293"></a>01293 
<a name="l01294"></a>01294       ++i;
<a name="l01295"></a>01295     }
<a name="l01296"></a>01296 }
<a name="l01297"></a>01297 
<a name="l01298"></a>01298 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01299"></a>01299 spew_tree (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree)
<a name="l01300"></a>01300 {
<a name="l01301"></a>01301   spew_subtree_recurse (tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a>, 0);
<a name="l01302"></a>01302 }
<a name="l01303"></a>01303 <span class="preprocessor">#endif</span>
<a name="l01304"></a>01304 <span class="preprocessor"></span>
<a name="l01308"></a>01308 <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l01309"></a>01309 {
<a name="l01310"></a>01310   <span class="keyword">const</span> <span class="keywordtype">char</span> **path; 
<a name="l01311"></a>01311   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> handler_fallback; 
<a name="l01312"></a>01312   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> message_handled; 
<a name="l01313"></a>01313   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> handler_unregistered; 
<a name="l01314"></a>01314 } TreeTestData;
<a name="l01315"></a>01315 
<a name="l01316"></a>01316 
<a name="l01317"></a>01317 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01318"></a>01318 test_unregister_function (<a class="code" href="structDBusConnection.html" title="Implementation details of DBusConnection.">DBusConnection</a>  *connection,
<a name="l01319"></a>01319                           <span class="keywordtype">void</span>            *user_data)
<a name="l01320"></a>01320 {
<a name="l01321"></a>01321   TreeTestData *ttd = user_data;
<a name="l01322"></a>01322 
<a name="l01323"></a>01323   ttd-&gt;handler_unregistered = <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l01324"></a>01324 }
<a name="l01325"></a>01325 
<a name="l01326"></a>01326 <span class="keyword">static</span> <a class="code" href="group__DBusShared.html#ga8244b29230187624c24986c24edab1de" title="Results that a message handler can return.">DBusHandlerResult</a>
<a name="l01327"></a>01327 test_message_function (<a class="code" href="structDBusConnection.html" title="Implementation details of DBusConnection.">DBusConnection</a>  *connection,
<a name="l01328"></a>01328                        <a class="code" href="structDBusMessage.html" title="Internals of DBusMessage.">DBusMessage</a>     *message,
<a name="l01329"></a>01329                        <span class="keywordtype">void</span>            *user_data)
<a name="l01330"></a>01330 {
<a name="l01331"></a>01331   TreeTestData *ttd = user_data;
<a name="l01332"></a>01332 
<a name="l01333"></a>01333   ttd-&gt;message_handled = <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l01334"></a>01334 
<a name="l01335"></a>01335   <span class="keywordflow">return</span> <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1deacb84b64c92055f2585fe9c29f1e5df68" title="Message has not had any effect - see if other handlers want it.">DBUS_HANDLER_RESULT_NOT_YET_HANDLED</a>;
<a name="l01336"></a>01336 }
<a name="l01337"></a>01337 
<a name="l01338"></a>01338 <span class="keyword">static</span> <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l01339"></a>01339 do_register (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l01340"></a>01340              <span class="keyword">const</span> <span class="keywordtype">char</span>    **path,
<a name="l01341"></a>01341              <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>     fallback,
<a name="l01342"></a>01342              <span class="keywordtype">int</span>             i,
<a name="l01343"></a>01343              TreeTestData   *tree_test_data)
<a name="l01344"></a>01344 {
<a name="l01345"></a>01345   <a class="code" href="structDBusObjectPathVTable.html" title="Virtual table that must be implemented to handle a portion of the object path hierarchy.">DBusObjectPathVTable</a> vtable = { test_unregister_function,
<a name="l01346"></a>01346                                   test_message_function, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01347"></a>01347 
<a name="l01348"></a>01348   tree_test_data[i].message_handled = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01349"></a>01349   tree_test_data[i].handler_unregistered = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01350"></a>01350   tree_test_data[i].handler_fallback = fallback;
<a name="l01351"></a>01351   tree_test_data[i].path = path;
<a name="l01352"></a>01352 
<a name="l01353"></a>01353   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusObjectTree.html#gab3da15ee1a73d3b26008d1bce20a78a0" title="Registers a new subtree in the global object tree.">_dbus_object_tree_register</a> (tree, fallback, path,
<a name="l01354"></a>01354                                    &amp;vtable,
<a name="l01355"></a>01355                                    &amp;tree_test_data[i],
<a name="l01356"></a>01356                                    <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>))
<a name="l01357"></a>01357     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01358"></a>01358 
<a name="l01359"></a>01359   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path) ==
<a name="l01360"></a>01360                 &amp;tree_test_data[i]);
<a name="l01361"></a>01361   
<a name="l01362"></a>01362   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l01363"></a>01363 }
<a name="l01364"></a>01364 
<a name="l01365"></a>01365 <span class="keyword">static</span> <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l01366"></a>01366 do_test_dispatch (<a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree,
<a name="l01367"></a>01367                   <span class="keyword">const</span> <span class="keywordtype">char</span>    **path,
<a name="l01368"></a>01368                   <span class="keywordtype">int</span>             i,
<a name="l01369"></a>01369                   TreeTestData   *tree_test_data,
<a name="l01370"></a>01370                   <span class="keywordtype">int</span>             n_test_data)
<a name="l01371"></a>01371 {
<a name="l01372"></a>01372   <a class="code" href="structDBusMessage.html" title="Internals of DBusMessage.">DBusMessage</a> *message;
<a name="l01373"></a>01373   <span class="keywordtype">int</span> j;
<a name="l01374"></a>01374   <a class="code" href="group__DBusShared.html#ga8244b29230187624c24986c24edab1de" title="Results that a message handler can return.">DBusHandlerResult</a> result;
<a name="l01375"></a>01375   <span class="keywordtype">char</span> *flat;
<a name="l01376"></a>01376 
<a name="l01377"></a>01377   message = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l01378"></a>01378   
<a name="l01379"></a>01379   flat = flatten_path (path);
<a name="l01380"></a>01380   <span class="keywordflow">if</span> (flat == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01381"></a>01381     <span class="keywordflow">goto</span> oom;
<a name="l01382"></a>01382 
<a name="l01383"></a>01383   message = <a class="code" href="group__DBusMessage.html#ga6c8a4c5d350c1962b11300cc4dd0c2e2" title="Constructs a new message to invoke a method on a remote object.">dbus_message_new_method_call</a> (<a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>,
<a name="l01384"></a>01384                                           flat,
<a name="l01385"></a>01385                                           <span class="stringliteral">&quot;org.freedesktop.TestInterface&quot;</span>,
<a name="l01386"></a>01386                                           <span class="stringliteral">&quot;Foo&quot;</span>);
<a name="l01387"></a>01387   <a class="code" href="group__DBusMemory.html#ga34e666b19b015035a9a31e53da84b39a" title="Frees a block of memory previously allocated by dbus_malloc() or dbus_malloc0().">dbus_free</a> (flat);
<a name="l01388"></a>01388   <span class="keywordflow">if</span> (message == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01389"></a>01389     <span class="keywordflow">goto</span> oom;
<a name="l01390"></a>01390 
<a name="l01391"></a>01391   j = 0;
<a name="l01392"></a>01392   <span class="keywordflow">while</span> (j &lt; n_test_data)
<a name="l01393"></a>01393     {
<a name="l01394"></a>01394       tree_test_data[j].message_handled = <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01395"></a>01395       ++j;
<a name="l01396"></a>01396     }
<a name="l01397"></a>01397 
<a name="l01398"></a>01398   result = <a class="code" href="group__DBusObjectTree.html#gad660d78a12fa207d891838863dfc6ba7" title="Tries to dispatch a message by directing it to handler for the object path listed in the message head...">_dbus_object_tree_dispatch_and_unlock</a> (tree, message, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01399"></a>01399   <span class="keywordflow">if</span> (result == <a class="code" href="group__DBusShared.html#gga8244b29230187624c24986c24edab1dea01f00ce4578559c7b14b91256bfede7d" title="Need more memory in order to return DBUS_HANDLER_RESULT_HANDLED or DBUS_HANDLER_RESULT_NOT_YET_HANDLE...">DBUS_HANDLER_RESULT_NEED_MEMORY</a>)
<a name="l01400"></a>01400     <span class="keywordflow">goto</span> oom;
<a name="l01401"></a>01401 
<a name="l01402"></a>01402   _dbus_assert (tree_test_data[i].message_handled);
<a name="l01403"></a>01403 
<a name="l01404"></a>01404   j = 0;
<a name="l01405"></a>01405   <span class="keywordflow">while</span> (j &lt; n_test_data)
<a name="l01406"></a>01406     {
<a name="l01407"></a>01407       <span class="keywordflow">if</span> (tree_test_data[j].message_handled)
<a name="l01408"></a>01408         {
<a name="l01409"></a>01409           <span class="keywordflow">if</span> (tree_test_data[j].handler_fallback)
<a name="l01410"></a>01410             _dbus_assert (path_contains (tree_test_data[j].path,
<a name="l01411"></a>01411                                          path) != STR_DIFFERENT);
<a name="l01412"></a>01412           <span class="keywordflow">else</span>
<a name="l01413"></a>01413             _dbus_assert (path_contains (tree_test_data[j].path, path) == STR_EQUAL);
<a name="l01414"></a>01414         }
<a name="l01415"></a>01415       <span class="keywordflow">else</span>
<a name="l01416"></a>01416         {
<a name="l01417"></a>01417           <span class="keywordflow">if</span> (tree_test_data[j].handler_fallback)
<a name="l01418"></a>01418             _dbus_assert (path_contains (tree_test_data[j].path,
<a name="l01419"></a>01419                                          path) == STR_DIFFERENT);
<a name="l01420"></a>01420           <span class="keywordflow">else</span>
<a name="l01421"></a>01421             _dbus_assert (path_contains (tree_test_data[j].path, path) != STR_EQUAL);
<a name="l01422"></a>01422         }
<a name="l01423"></a>01423 
<a name="l01424"></a>01424       ++j;
<a name="l01425"></a>01425     }
<a name="l01426"></a>01426 
<a name="l01427"></a>01427   <a class="code" href="group__DBusMessage.html#gab69441efe683918f6a82469c8763f464" title="Decrements the reference count of a DBusMessage, freeing the message if the count reaches 0...">dbus_message_unref</a> (message);
<a name="l01428"></a>01428 
<a name="l01429"></a>01429   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l01430"></a>01430 
<a name="l01431"></a>01431  oom:
<a name="l01432"></a>01432   <span class="keywordflow">if</span> (message)
<a name="l01433"></a>01433     <a class="code" href="group__DBusMessage.html#gab69441efe683918f6a82469c8763f464" title="Decrements the reference count of a DBusMessage, freeing the message if the count reaches 0...">dbus_message_unref</a> (message);
<a name="l01434"></a>01434   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01435"></a>01435 }
<a name="l01436"></a>01436 
<a name="l01437"></a>01437 <span class="keyword">static</span> <span class="keywordtype">size_t</span>
<a name="l01438"></a>01438 string_array_length (<span class="keyword">const</span> <span class="keywordtype">char</span> **array)
<a name="l01439"></a>01439 {
<a name="l01440"></a>01440   <span class="keywordtype">size_t</span> i;
<a name="l01441"></a>01441   <span class="keywordflow">for</span> (i = 0; array[i]; i++) ;
<a name="l01442"></a>01442   <span class="keywordflow">return</span> i;
<a name="l01443"></a>01443 }
<a name="l01444"></a>01444 
<a name="l01445"></a>01445 <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l01446"></a>01446 {
<a name="l01447"></a>01447   <span class="keyword">const</span> <span class="keywordtype">char</span> *path;
<a name="l01448"></a>01448   <span class="keyword">const</span> <span class="keywordtype">char</span> *result[20];
<a name="l01449"></a>01449 } DecomposePathTest;
<a name="l01450"></a>01450 
<a name="l01451"></a>01451 <span class="keyword">static</span> DecomposePathTest decompose_tests[] = {
<a name="l01452"></a>01452   { <span class="stringliteral">&quot;/foo&quot;</span>, { <span class="stringliteral">&quot;foo&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> } },
<a name="l01453"></a>01453   { <span class="stringliteral">&quot;/foo/bar&quot;</span>, { <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> } },
<a name="l01454"></a>01454   { <span class="stringliteral">&quot;/&quot;</span>, { <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> } },
<a name="l01455"></a>01455   { <span class="stringliteral">&quot;/a/b&quot;</span>, { <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> } },
<a name="l01456"></a>01456   { <span class="stringliteral">&quot;/a/b/c&quot;</span>, { <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> } },
<a name="l01457"></a>01457   { <span class="stringliteral">&quot;/a/b/c/d&quot;</span>, { <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;c&quot;</span>, <span class="stringliteral">&quot;d&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> } },
<a name="l01458"></a>01458   { <span class="stringliteral">&quot;/foo/bar/q&quot;</span>, { <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;q&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> } },
<a name="l01459"></a>01459   { <span class="stringliteral">&quot;/foo/bar/this/is/longer&quot;</span>, { <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;this&quot;</span>, <span class="stringliteral">&quot;is&quot;</span>, <span class="stringliteral">&quot;longer&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> } }
<a name="l01460"></a>01460 };
<a name="l01461"></a>01461 
<a name="l01462"></a>01462 <span class="keyword">static</span> <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l01463"></a>01463 run_decompose_tests (<span class="keywordtype">void</span>)
<a name="l01464"></a>01464 {
<a name="l01465"></a>01465   <span class="keywordtype">int</span> i;
<a name="l01466"></a>01466 
<a name="l01467"></a>01467   i = 0;
<a name="l01468"></a>01468   <span class="keywordflow">while</span> (i &lt; _DBUS_N_ELEMENTS (decompose_tests))
<a name="l01469"></a>01469     {
<a name="l01470"></a>01470       <span class="keywordtype">char</span> **result;
<a name="l01471"></a>01471       <span class="keywordtype">int</span>    result_len;
<a name="l01472"></a>01472       <span class="keywordtype">int</span>    expected_len;
<a name="l01473"></a>01473 
<a name="l01474"></a>01474       <span class="keywordflow">if</span> (!<a class="code" href="group__DBusObjectTree.html#gab282b916368cd512842d3aaae31e65c7" title="Decompose an object path.">_dbus_decompose_path</a> (decompose_tests[i].path,
<a name="l01475"></a>01475                                  strlen (decompose_tests[i].path),
<a name="l01476"></a>01476                                  &amp;result, &amp;result_len))
<a name="l01477"></a>01477         <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01478"></a>01478 
<a name="l01479"></a>01479       expected_len = string_array_length (decompose_tests[i].result);
<a name="l01480"></a>01480       
<a name="l01481"></a>01481       <span class="keywordflow">if</span> (result_len != (<span class="keywordtype">int</span>) string_array_length ((<span class="keyword">const</span> <span class="keywordtype">char</span>**)result) ||
<a name="l01482"></a>01482           expected_len != result_len ||
<a name="l01483"></a>01483           path_contains (decompose_tests[i].result,
<a name="l01484"></a>01484                          (<span class="keyword">const</span> <span class="keywordtype">char</span>**) result) != STR_EQUAL)
<a name="l01485"></a>01485         {
<a name="l01486"></a>01486           <span class="keywordtype">int</span> real_len = string_array_length ((<span class="keyword">const</span> <span class="keywordtype">char</span>**)result);
<a name="l01487"></a>01487           <a class="code" href="group__DBusInternalsUtils.html#gabea2c16d6d3fe7c4eb5b9496fc877f84" title="Prints a warning message to stderr.">_dbus_warn</a> (<span class="stringliteral">&quot;Expected decompose of %s to have len %d, returned %d, appears to have %d\n&quot;</span>,
<a name="l01488"></a>01488                       decompose_tests[i].path, expected_len, result_len,
<a name="l01489"></a>01489                       real_len);
<a name="l01490"></a>01490           <a class="code" href="group__DBusInternalsUtils.html#gabea2c16d6d3fe7c4eb5b9496fc877f84" title="Prints a warning message to stderr.">_dbus_warn</a> (<span class="stringliteral">&quot;Decompose resulted in elements: { &quot;</span>);
<a name="l01491"></a>01491           i = 0;
<a name="l01492"></a>01492           <span class="keywordflow">while</span> (i &lt; real_len)
<a name="l01493"></a>01493             {
<a name="l01494"></a>01494               <a class="code" href="group__DBusInternalsUtils.html#gabea2c16d6d3fe7c4eb5b9496fc877f84" title="Prints a warning message to stderr.">_dbus_warn</a> (<span class="stringliteral">&quot;\&quot;%s\&quot;%s&quot;</span>, result[i],
<a name="l01495"></a>01495                           (i + 1) == real_len ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;, &quot;</span>);
<a name="l01496"></a>01496               ++i;
<a name="l01497"></a>01497             }
<a name="l01498"></a>01498           <a class="code" href="group__DBusInternalsUtils.html#gabea2c16d6d3fe7c4eb5b9496fc877f84" title="Prints a warning message to stderr.">_dbus_warn</a> (<span class="stringliteral">&quot;}\n&quot;</span>);
<a name="l01499"></a>01499           _dbus_assert_not_reached (<span class="stringliteral">&quot;path decompose failed\n&quot;</span>);
<a name="l01500"></a>01500         }
<a name="l01501"></a>01501 
<a name="l01502"></a>01502       <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (result);
<a name="l01503"></a>01503 
<a name="l01504"></a>01504       ++i;
<a name="l01505"></a>01505     }
<a name="l01506"></a>01506   
<a name="l01507"></a>01507   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l01508"></a>01508 }
<a name="l01509"></a>01509 
<a name="l01510"></a>01510 <span class="keyword">static</span> <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l01511"></a>01511 object_tree_test_iteration (<span class="keywordtype">void</span> *data)
<a name="l01512"></a>01512 {
<a name="l01513"></a>01513   <span class="keyword">const</span> <span class="keywordtype">char</span> *path0[] = { <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01514"></a>01514   <span class="keyword">const</span> <span class="keywordtype">char</span> *path1[] = { <span class="stringliteral">&quot;foo&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01515"></a>01515   <span class="keyword">const</span> <span class="keywordtype">char</span> *path2[] = { <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01516"></a>01516   <span class="keyword">const</span> <span class="keywordtype">char</span> *path3[] = { <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;baz&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01517"></a>01517   <span class="keyword">const</span> <span class="keywordtype">char</span> *path4[] = { <span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>, <span class="stringliteral">&quot;boo&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01518"></a>01518   <span class="keyword">const</span> <span class="keywordtype">char</span> *path5[] = { <span class="stringliteral">&quot;blah&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01519"></a>01519   <span class="keyword">const</span> <span class="keywordtype">char</span> *path6[] = { <span class="stringliteral">&quot;blah&quot;</span>, <span class="stringliteral">&quot;boof&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01520"></a>01520   <span class="keyword">const</span> <span class="keywordtype">char</span> *path7[] = { <span class="stringliteral">&quot;blah&quot;</span>, <span class="stringliteral">&quot;boof&quot;</span>, <span class="stringliteral">&quot;this&quot;</span>, <span class="stringliteral">&quot;is&quot;</span>, <span class="stringliteral">&quot;really&quot;</span>, <span class="stringliteral">&quot;long&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01521"></a>01521   <span class="keyword">const</span> <span class="keywordtype">char</span> *path8[] = { <span class="stringliteral">&quot;childless&quot;</span>, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01522"></a>01522   <a class="code" href="structDBusObjectTree.html" title="Internals of DBusObjectTree.">DBusObjectTree</a> *tree;
<a name="l01523"></a>01523   TreeTestData tree_test_data[9];
<a name="l01524"></a>01524   <span class="keywordtype">int</span> i;
<a name="l01525"></a>01525   <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a> exact_match;
<a name="l01526"></a>01526 
<a name="l01527"></a>01527   <span class="keywordflow">if</span> (!run_decompose_tests ())
<a name="l01528"></a>01528     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>;
<a name="l01529"></a>01529   
<a name="l01530"></a>01530   tree = <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>;
<a name="l01531"></a>01531 
<a name="l01532"></a>01532   tree = <a class="code" href="group__DBusObjectTree.html#ga5920f14b487122f13a3d439952d5ed2e" title="Creates a new object tree, representing a mapping from paths to handler vtables.">_dbus_object_tree_new</a> (<a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01533"></a>01533   <span class="keywordflow">if</span> (tree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01534"></a>01534     <span class="keywordflow">goto</span> out;
<a name="l01535"></a>01535 
<a name="l01536"></a>01536   <span class="keywordflow">if</span> (!do_register (tree, path0, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 0, tree_test_data))
<a name="l01537"></a>01537     <span class="keywordflow">goto</span> out;
<a name="l01538"></a>01538 
<a name="l01539"></a>01539   _dbus_assert (find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01540"></a>01540   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01541"></a>01541   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01542"></a>01542   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01543"></a>01543   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01544"></a>01544   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01545"></a>01545   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01546"></a>01546   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01547"></a>01547   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01548"></a>01548 
<a name="l01549"></a>01549   _dbus_assert (find_handler (tree, path0, &amp;exact_match) &amp;&amp; exact_match);
<a name="l01550"></a>01550   _dbus_assert (find_handler (tree, path1, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01551"></a>01551   _dbus_assert (find_handler (tree, path2, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01552"></a>01552   _dbus_assert (find_handler (tree, path3, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01553"></a>01553   _dbus_assert (find_handler (tree, path4, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01554"></a>01554   _dbus_assert (find_handler (tree, path5, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01555"></a>01555   _dbus_assert (find_handler (tree, path6, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01556"></a>01556   _dbus_assert (find_handler (tree, path7, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01557"></a>01557   _dbus_assert (find_handler (tree, path8, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01558"></a>01558   
<a name="l01559"></a>01559   <span class="keywordflow">if</span> (!do_register (tree, path1, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 1, tree_test_data))
<a name="l01560"></a>01560     <span class="keywordflow">goto</span> out;
<a name="l01561"></a>01561 
<a name="l01562"></a>01562   _dbus_assert (find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01563"></a>01563   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01564"></a>01564   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01565"></a>01565   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01566"></a>01566   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01567"></a>01567   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01568"></a>01568   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01569"></a>01569   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01570"></a>01570   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01571"></a>01571 
<a name="l01572"></a>01572   _dbus_assert (find_handler (tree, path0, &amp;exact_match) &amp;&amp;  exact_match);
<a name="l01573"></a>01573   _dbus_assert (find_handler (tree, path1, &amp;exact_match) &amp;&amp;  exact_match);
<a name="l01574"></a>01574   _dbus_assert (find_handler (tree, path2, &amp;exact_match) &amp;&amp; !exact_match);
<a name="l01575"></a>01575   _dbus_assert (find_handler (tree, path3, &amp;exact_match) &amp;&amp; !exact_match);
<a name="l01576"></a>01576   _dbus_assert (find_handler (tree, path4, &amp;exact_match) &amp;&amp; !exact_match);
<a name="l01577"></a>01577   _dbus_assert (find_handler (tree, path5, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01578"></a>01578   _dbus_assert (find_handler (tree, path6, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01579"></a>01579   _dbus_assert (find_handler (tree, path7, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01580"></a>01580   _dbus_assert (find_handler (tree, path8, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01581"></a>01581 
<a name="l01582"></a>01582   <span class="keywordflow">if</span> (!do_register (tree, path2, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 2, tree_test_data))
<a name="l01583"></a>01583     <span class="keywordflow">goto</span> out;
<a name="l01584"></a>01584 
<a name="l01585"></a>01585   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01586"></a>01586   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01587"></a>01587   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01588"></a>01588   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01589"></a>01589   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01590"></a>01590   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01591"></a>01591   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01592"></a>01592   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01593"></a>01593 
<a name="l01594"></a>01594   <span class="keywordflow">if</span> (!do_register (tree, path3, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 3, tree_test_data))
<a name="l01595"></a>01595     <span class="keywordflow">goto</span> out;
<a name="l01596"></a>01596 
<a name="l01597"></a>01597   _dbus_assert (find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01598"></a>01598   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01599"></a>01599   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01600"></a>01600   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01601"></a>01601   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01602"></a>01602   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01603"></a>01603   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01604"></a>01604   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01605"></a>01605   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01606"></a>01606   
<a name="l01607"></a>01607   <span class="keywordflow">if</span> (!do_register (tree, path4, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 4, tree_test_data))
<a name="l01608"></a>01608     <span class="keywordflow">goto</span> out;
<a name="l01609"></a>01609 
<a name="l01610"></a>01610   _dbus_assert (find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01611"></a>01611   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01612"></a>01612   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01613"></a>01613   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));  
<a name="l01614"></a>01614   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01615"></a>01615   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01616"></a>01616   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01617"></a>01617   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01618"></a>01618   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01619"></a>01619   
<a name="l01620"></a>01620   <span class="keywordflow">if</span> (!do_register (tree, path5, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 5, tree_test_data))
<a name="l01621"></a>01621     <span class="keywordflow">goto</span> out;
<a name="l01622"></a>01622 
<a name="l01623"></a>01623   _dbus_assert (find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01624"></a>01624   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01625"></a>01625   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01626"></a>01626   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01627"></a>01627   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01628"></a>01628   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01629"></a>01629   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01630"></a>01630   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01631"></a>01631   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01632"></a>01632 
<a name="l01633"></a>01633   _dbus_assert (find_handler (tree, path0, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp;  exact_match);
<a name="l01634"></a>01634   _dbus_assert (find_handler (tree, path1, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp;  exact_match);
<a name="l01635"></a>01635   _dbus_assert (find_handler (tree, path2, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp;  exact_match);
<a name="l01636"></a>01636   _dbus_assert (find_handler (tree, path3, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp;  exact_match);
<a name="l01637"></a>01637   _dbus_assert (find_handler (tree, path4, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp;  exact_match);
<a name="l01638"></a>01638   _dbus_assert (find_handler (tree, path5, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp;  exact_match);
<a name="l01639"></a>01639   _dbus_assert (find_handler (tree, path6, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01640"></a>01640   _dbus_assert (find_handler (tree, path7, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01641"></a>01641   _dbus_assert (find_handler (tree, path8, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; !exact_match);
<a name="l01642"></a>01642 
<a name="l01643"></a>01643   <span class="keywordflow">if</span> (!do_register (tree, path6, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 6, tree_test_data))
<a name="l01644"></a>01644     <span class="keywordflow">goto</span> out;
<a name="l01645"></a>01645 
<a name="l01646"></a>01646   _dbus_assert (find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01647"></a>01647   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01648"></a>01648   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01649"></a>01649   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01650"></a>01650   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01651"></a>01651   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01652"></a>01652   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01653"></a>01653   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01654"></a>01654   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01655"></a>01655 
<a name="l01656"></a>01656   <span class="keywordflow">if</span> (!do_register (tree, path7, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 7, tree_test_data))
<a name="l01657"></a>01657     <span class="keywordflow">goto</span> out;
<a name="l01658"></a>01658 
<a name="l01659"></a>01659   _dbus_assert (find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01660"></a>01660   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01661"></a>01661   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01662"></a>01662   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01663"></a>01663   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01664"></a>01664   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01665"></a>01665   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01666"></a>01666   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01667"></a>01667   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01668"></a>01668 
<a name="l01669"></a>01669   <span class="keywordflow">if</span> (!do_register (tree, path8, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 8, tree_test_data))
<a name="l01670"></a>01670     <span class="keywordflow">goto</span> out;
<a name="l01671"></a>01671 
<a name="l01672"></a>01672   _dbus_assert (find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01673"></a>01673   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01674"></a>01674   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01675"></a>01675   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01676"></a>01676   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01677"></a>01677   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01678"></a>01678   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01679"></a>01679   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01680"></a>01680   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01681"></a>01681 
<a name="l01682"></a>01682   _dbus_assert (find_handler (tree, path0, &amp;exact_match) == tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp;  exact_match);
<a name="l01683"></a>01683   _dbus_assert (find_handler (tree, path1, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; exact_match);
<a name="l01684"></a>01684   _dbus_assert (find_handler (tree, path2, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; exact_match);
<a name="l01685"></a>01685   _dbus_assert (find_handler (tree, path3, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; exact_match);
<a name="l01686"></a>01686   _dbus_assert (find_handler (tree, path4, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; exact_match);
<a name="l01687"></a>01687   _dbus_assert (find_handler (tree, path5, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; exact_match);
<a name="l01688"></a>01688   _dbus_assert (find_handler (tree, path6, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; exact_match);
<a name="l01689"></a>01689   _dbus_assert (find_handler (tree, path7, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; exact_match);
<a name="l01690"></a>01690   _dbus_assert (find_handler (tree, path8, &amp;exact_match) != tree-&gt;<a class="code" href="structDBusObjectTree.html#a8d8b8d9801bb51c1f178074881249c26" title="Root of the tree (&quot;/&quot; node)">root</a> &amp;&amp; exact_match);
<a name="l01691"></a>01691   
<a name="l01692"></a>01692   <span class="comment">/* test the list_registered function */</span>
<a name="l01693"></a>01693 
<a name="l01694"></a>01694   {
<a name="l01695"></a>01695     <span class="keyword">const</span> <span class="keywordtype">char</span> *root[] = { <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a> };
<a name="l01696"></a>01696     <span class="keywordtype">char</span> **child_entries;
<a name="l01697"></a>01697     <span class="keywordtype">int</span> nb;
<a name="l01698"></a>01698 
<a name="l01699"></a>01699     _dbus_object_tree_list_registered_unlocked (tree, path1, &amp;child_entries);
<a name="l01700"></a>01700     <span class="keywordflow">if</span> (child_entries != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01701"></a>01701       {
<a name="l01702"></a>01702         nb = string_array_length ((<span class="keyword">const</span> <span class="keywordtype">char</span>**)child_entries);
<a name="l01703"></a>01703         _dbus_assert (nb == 1);
<a name="l01704"></a>01704         <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (child_entries);
<a name="l01705"></a>01705       }
<a name="l01706"></a>01706 
<a name="l01707"></a>01707     _dbus_object_tree_list_registered_unlocked (tree, path2, &amp;child_entries);
<a name="l01708"></a>01708     <span class="keywordflow">if</span> (child_entries != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01709"></a>01709       {
<a name="l01710"></a>01710         nb = string_array_length ((<span class="keyword">const</span> <span class="keywordtype">char</span>**)child_entries);
<a name="l01711"></a>01711         _dbus_assert (nb == 2);
<a name="l01712"></a>01712         <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (child_entries);
<a name="l01713"></a>01713       }
<a name="l01714"></a>01714 
<a name="l01715"></a>01715     _dbus_object_tree_list_registered_unlocked (tree, path8, &amp;child_entries);
<a name="l01716"></a>01716     <span class="keywordflow">if</span> (child_entries != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01717"></a>01717       {
<a name="l01718"></a>01718         nb = string_array_length ((<span class="keyword">const</span> <span class="keywordtype">char</span>**)child_entries);
<a name="l01719"></a>01719         _dbus_assert (nb == 0);
<a name="l01720"></a>01720         <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (child_entries);
<a name="l01721"></a>01721       }
<a name="l01722"></a>01722 
<a name="l01723"></a>01723     _dbus_object_tree_list_registered_unlocked (tree, root, &amp;child_entries);
<a name="l01724"></a>01724     <span class="keywordflow">if</span> (child_entries != <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01725"></a>01725       {
<a name="l01726"></a>01726         nb = string_array_length ((<span class="keyword">const</span> <span class="keywordtype">char</span>**)child_entries);
<a name="l01727"></a>01727         _dbus_assert (nb == 3);
<a name="l01728"></a>01728         <a class="code" href="group__DBusMemory.html#gac200b2dbc8b3f6ecac4d42426fb97b40" title="Frees a NULL-terminated array of strings.">dbus_free_string_array</a> (child_entries);
<a name="l01729"></a>01729       }
<a name="l01730"></a>01730   }
<a name="l01731"></a>01731 
<a name="l01732"></a>01732   <span class="comment">/* Check that destroying tree calls unregister funcs */</span>
<a name="l01733"></a>01733   <a class="code" href="group__DBusObjectTree.html#ga7639e273ab160c422a7cef0cda60ded5" title="Decrement the reference count.">_dbus_object_tree_unref</a> (tree);
<a name="l01734"></a>01734 
<a name="l01735"></a>01735   i = 0;
<a name="l01736"></a>01736   <span class="keywordflow">while</span> (i &lt; (<span class="keywordtype">int</span>) _DBUS_N_ELEMENTS (tree_test_data))
<a name="l01737"></a>01737     {
<a name="l01738"></a>01738       _dbus_assert (tree_test_data[i].handler_unregistered);
<a name="l01739"></a>01739       _dbus_assert (!tree_test_data[i].message_handled);
<a name="l01740"></a>01740       ++i;
<a name="l01741"></a>01741     }
<a name="l01742"></a>01742 
<a name="l01743"></a>01743   <span class="comment">/* Now start again and try the individual unregister function */</span>
<a name="l01744"></a>01744   tree = <a class="code" href="group__DBusObjectTree.html#ga5920f14b487122f13a3d439952d5ed2e" title="Creates a new object tree, representing a mapping from paths to handler vtables.">_dbus_object_tree_new</a> (<a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01745"></a>01745   <span class="keywordflow">if</span> (tree == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>)
<a name="l01746"></a>01746     <span class="keywordflow">goto</span> out;
<a name="l01747"></a>01747 
<a name="l01748"></a>01748   <span class="keywordflow">if</span> (!do_register (tree, path0, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 0, tree_test_data))
<a name="l01749"></a>01749     <span class="keywordflow">goto</span> out;
<a name="l01750"></a>01750   <span class="keywordflow">if</span> (!do_register (tree, path1, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 1, tree_test_data))
<a name="l01751"></a>01751     <span class="keywordflow">goto</span> out;
<a name="l01752"></a>01752   <span class="keywordflow">if</span> (!do_register (tree, path2, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 2, tree_test_data))
<a name="l01753"></a>01753     <span class="keywordflow">goto</span> out;
<a name="l01754"></a>01754   <span class="keywordflow">if</span> (!do_register (tree, path3, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 3, tree_test_data))
<a name="l01755"></a>01755     <span class="keywordflow">goto</span> out;
<a name="l01756"></a>01756   <span class="keywordflow">if</span> (!do_register (tree, path4, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 4, tree_test_data))
<a name="l01757"></a>01757     <span class="keywordflow">goto</span> out;
<a name="l01758"></a>01758   <span class="keywordflow">if</span> (!do_register (tree, path5, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 5, tree_test_data))
<a name="l01759"></a>01759     <span class="keywordflow">goto</span> out;
<a name="l01760"></a>01760   <span class="keywordflow">if</span> (!do_register (tree, path6, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 6, tree_test_data))
<a name="l01761"></a>01761     <span class="keywordflow">goto</span> out;
<a name="l01762"></a>01762   <span class="keywordflow">if</span> (!do_register (tree, path7, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 7, tree_test_data))
<a name="l01763"></a>01763     <span class="keywordflow">goto</span> out;
<a name="l01764"></a>01764   <span class="keywordflow">if</span> (!do_register (tree, path8, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 8, tree_test_data))
<a name="l01765"></a>01765     <span class="keywordflow">goto</span> out;
<a name="l01766"></a>01766 
<a name="l01767"></a>01767   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path0);
<a name="l01768"></a>01768   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path0) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01769"></a>01769 
<a name="l01770"></a>01770   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01771"></a>01771   _dbus_assert (find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01772"></a>01772   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01773"></a>01773   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01774"></a>01774   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01775"></a>01775   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01776"></a>01776   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01777"></a>01777   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01778"></a>01778   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01779"></a>01779   
<a name="l01780"></a>01780   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path1);
<a name="l01781"></a>01781   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path1) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01782"></a>01782 
<a name="l01783"></a>01783   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01784"></a>01784   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01785"></a>01785   _dbus_assert (find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01786"></a>01786   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01787"></a>01787   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01788"></a>01788   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01789"></a>01789   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01790"></a>01790   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01791"></a>01791   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01792"></a>01792 
<a name="l01793"></a>01793   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path2);
<a name="l01794"></a>01794   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path2) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01795"></a>01795 
<a name="l01796"></a>01796   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01797"></a>01797   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01798"></a>01798   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01799"></a>01799   _dbus_assert (find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01800"></a>01800   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01801"></a>01801   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01802"></a>01802   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01803"></a>01803   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01804"></a>01804   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01805"></a>01805   
<a name="l01806"></a>01806   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path3);
<a name="l01807"></a>01807   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path3) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01808"></a>01808 
<a name="l01809"></a>01809   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01810"></a>01810   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01811"></a>01811   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01812"></a>01812   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01813"></a>01813   _dbus_assert (find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01814"></a>01814   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01815"></a>01815   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01816"></a>01816   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01817"></a>01817   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01818"></a>01818   
<a name="l01819"></a>01819   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path4);
<a name="l01820"></a>01820   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path4) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01821"></a>01821 
<a name="l01822"></a>01822   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01823"></a>01823   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01824"></a>01824   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01825"></a>01825   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01826"></a>01826   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01827"></a>01827   _dbus_assert (find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01828"></a>01828   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01829"></a>01829   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01830"></a>01830   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01831"></a>01831   
<a name="l01832"></a>01832   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path5);
<a name="l01833"></a>01833   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path5) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01834"></a>01834 
<a name="l01835"></a>01835   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01836"></a>01836   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01837"></a>01837   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01838"></a>01838   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01839"></a>01839   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01840"></a>01840   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01841"></a>01841   _dbus_assert (find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01842"></a>01842   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01843"></a>01843   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01844"></a>01844   
<a name="l01845"></a>01845   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path6);
<a name="l01846"></a>01846   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path6) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01847"></a>01847 
<a name="l01848"></a>01848   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01849"></a>01849   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01850"></a>01850   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01851"></a>01851   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01852"></a>01852   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01853"></a>01853   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01854"></a>01854   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01855"></a>01855   _dbus_assert (find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01856"></a>01856   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01857"></a>01857 
<a name="l01858"></a>01858   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path7);
<a name="l01859"></a>01859   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path7) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01860"></a>01860 
<a name="l01861"></a>01861   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01862"></a>01862   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01863"></a>01863   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01864"></a>01864   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01865"></a>01865   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01866"></a>01866   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01867"></a>01867   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01868"></a>01868   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01869"></a>01869   _dbus_assert (find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01870"></a>01870 
<a name="l01871"></a>01871   <a class="code" href="group__DBusObjectTree.html#ga3babe73ed342b6963997ef2efd73ef75" title="Unregisters an object subtree that was registered with the same path.">_dbus_object_tree_unregister_and_unlock</a> (tree, path8);
<a name="l01872"></a>01872   _dbus_assert (<a class="code" href="group__DBusObjectTree.html#ga4cf5a5f35d2bd18b6fa8aa58ba6b5de4" title="Looks up the data passed to _dbus_object_tree_register() for a handler at the given path...">_dbus_object_tree_get_user_data_unlocked</a> (tree, path8) == <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01873"></a>01873 
<a name="l01874"></a>01874   _dbus_assert (!find_subtree (tree, path0, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01875"></a>01875   _dbus_assert (!find_subtree (tree, path1, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01876"></a>01876   _dbus_assert (!find_subtree (tree, path2, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01877"></a>01877   _dbus_assert (!find_subtree (tree, path3, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01878"></a>01878   _dbus_assert (!find_subtree (tree, path4, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01879"></a>01879   _dbus_assert (!find_subtree (tree, path5, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01880"></a>01880   _dbus_assert (!find_subtree (tree, path6, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01881"></a>01881   _dbus_assert (!find_subtree (tree, path7, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01882"></a>01882   _dbus_assert (!find_subtree (tree, path8, <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>));
<a name="l01883"></a>01883   
<a name="l01884"></a>01884   i = 0;
<a name="l01885"></a>01885   <span class="keywordflow">while</span> (i &lt; (<span class="keywordtype">int</span>) _DBUS_N_ELEMENTS (tree_test_data))
<a name="l01886"></a>01886     {
<a name="l01887"></a>01887       _dbus_assert (tree_test_data[i].handler_unregistered);
<a name="l01888"></a>01888       _dbus_assert (!tree_test_data[i].message_handled);
<a name="l01889"></a>01889       ++i;
<a name="l01890"></a>01890     }
<a name="l01891"></a>01891 
<a name="l01892"></a>01892   <span class="comment">/* Register it all again, and test dispatch */</span>
<a name="l01893"></a>01893   
<a name="l01894"></a>01894   <span class="keywordflow">if</span> (!do_register (tree, path0, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 0, tree_test_data))
<a name="l01895"></a>01895     <span class="keywordflow">goto</span> out;
<a name="l01896"></a>01896   <span class="keywordflow">if</span> (!do_register (tree, path1, <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>, 1, tree_test_data))
<a name="l01897"></a>01897     <span class="keywordflow">goto</span> out;
<a name="l01898"></a>01898   <span class="keywordflow">if</span> (!do_register (tree, path2, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 2, tree_test_data))
<a name="l01899"></a>01899     <span class="keywordflow">goto</span> out;
<a name="l01900"></a>01900   <span class="keywordflow">if</span> (!do_register (tree, path3, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 3, tree_test_data))
<a name="l01901"></a>01901     <span class="keywordflow">goto</span> out;
<a name="l01902"></a>01902   <span class="keywordflow">if</span> (!do_register (tree, path4, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 4, tree_test_data))
<a name="l01903"></a>01903     <span class="keywordflow">goto</span> out;
<a name="l01904"></a>01904   <span class="keywordflow">if</span> (!do_register (tree, path5, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 5, tree_test_data))
<a name="l01905"></a>01905     <span class="keywordflow">goto</span> out;
<a name="l01906"></a>01906   <span class="keywordflow">if</span> (!do_register (tree, path6, <a class="code" href="group__DBusMacros.html#gaa93f0eb578d23995850d61f7d61c55c1" title="Expands to &quot;0&quot;.">FALSE</a>, 6, tree_test_data))
<a name="l01907"></a>01907     <span class="keywordflow">goto</span> out;
<a name="l01908"></a>01908   <span class="keywordflow">if</span> (!do_register (tree, path7, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 7, tree_test_data))
<a name="l01909"></a>01909     <span class="keywordflow">goto</span> out;
<a name="l01910"></a>01910   <span class="keywordflow">if</span> (!do_register (tree, path8, <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>, 8, tree_test_data))
<a name="l01911"></a>01911     <span class="keywordflow">goto</span> out;
<a name="l01912"></a>01912 
<a name="l01913"></a>01913 <span class="preprocessor">#if 0</span>
<a name="l01914"></a>01914 <span class="preprocessor"></span>  spew_tree (tree);
<a name="l01915"></a>01915 <span class="preprocessor">#endif</span>
<a name="l01916"></a>01916 <span class="preprocessor"></span>
<a name="l01917"></a>01917   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path0, 0, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01918"></a>01918     <span class="keywordflow">goto</span> out;
<a name="l01919"></a>01919   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path1, 1, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01920"></a>01920     <span class="keywordflow">goto</span> out;
<a name="l01921"></a>01921   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path2, 2, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01922"></a>01922     <span class="keywordflow">goto</span> out;
<a name="l01923"></a>01923   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path3, 3, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01924"></a>01924     <span class="keywordflow">goto</span> out;
<a name="l01925"></a>01925   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path4, 4, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01926"></a>01926     <span class="keywordflow">goto</span> out;
<a name="l01927"></a>01927   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path5, 5, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01928"></a>01928     <span class="keywordflow">goto</span> out;
<a name="l01929"></a>01929   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path6, 6, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01930"></a>01930     <span class="keywordflow">goto</span> out;
<a name="l01931"></a>01931   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path7, 7, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01932"></a>01932     <span class="keywordflow">goto</span> out;
<a name="l01933"></a>01933   <span class="keywordflow">if</span> (!do_test_dispatch (tree, path8, 8, tree_test_data, _DBUS_N_ELEMENTS (tree_test_data)))
<a name="l01934"></a>01934     <span class="keywordflow">goto</span> out;
<a name="l01935"></a>01935   
<a name="l01936"></a>01936  out:
<a name="l01937"></a>01937   <span class="keywordflow">if</span> (tree)
<a name="l01938"></a>01938     {
<a name="l01939"></a>01939       <span class="comment">/* test ref */</span>
<a name="l01940"></a>01940       <a class="code" href="group__DBusObjectTree.html#ga144a3920922e8badf1018ce22b27d9c4" title="Increment the reference count.">_dbus_object_tree_ref</a> (tree);
<a name="l01941"></a>01941       <a class="code" href="group__DBusObjectTree.html#ga7639e273ab160c422a7cef0cda60ded5" title="Decrement the reference count.">_dbus_object_tree_unref</a> (tree);
<a name="l01942"></a>01942       <a class="code" href="group__DBusObjectTree.html#ga7639e273ab160c422a7cef0cda60ded5" title="Decrement the reference count.">_dbus_object_tree_unref</a> (tree);
<a name="l01943"></a>01943     }
<a name="l01944"></a>01944 
<a name="l01945"></a>01945   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l01946"></a>01946 }
<a name="l01947"></a>01947 
<a name="l01953"></a>01953 <a class="code" href="group__DBusTypes.html#ga39c9cb0f3a2a8ad6f55cc4855d035349" title="A boolean, valid values are TRUE and FALSE.">dbus_bool_t</a>
<a name="l01954"></a>01954 _dbus_object_tree_test (<span class="keywordtype">void</span>)
<a name="l01955"></a>01955 {
<a name="l01956"></a>01956   _dbus_test_oom_handling (<span class="stringliteral">&quot;object tree&quot;</span>,
<a name="l01957"></a>01957                            object_tree_test_iteration,
<a name="l01958"></a>01958                            <a class="code" href="group__DBusMacros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4" title="A null pointer, defined appropriately for C or C++.">NULL</a>);
<a name="l01959"></a>01959 
<a name="l01960"></a>01960   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#gaa8cecfc5c5c054d2875c03e77b7be15d" title="Expands to &quot;1&quot;.">TRUE</a>;
<a name="l01961"></a>01961 }
<a name="l01962"></a>01962 
<a name="l01963"></a>01963 <span class="preprocessor">#endif </span><span class="comment">/* !DOXYGEN_SHOULD_SKIP_THIS */</span>
<a name="l01964"></a>01964 
<a name="l01965"></a>01965 <span class="preprocessor">#endif </span><span class="comment">/* DBUS_BUILD_TESTS */</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 21 2012 17:59:19 for D-Bus by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
